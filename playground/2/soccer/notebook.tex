
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Soccer Database Investigation - Data Analysis Process}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{project-soccer-database}{%
\section{Project: Soccer Database}\label{project-soccer-database}}

\hypertarget{table-of-contents}{%
\subsection{Table of Contents}\label{table-of-contents}}

Introduction

Data Wrangling

Exploratory Data Analysis

Conclusions

     \#\# Introduction

As part of course completion, I have chosen ``Soccer Database'' for
analysing the Soccer Matches and Players involved using Python Data
Analysis Frameworks like Pandas, Numpy, Matplotlib, Seaborn.

During the investigation, let's try if we can answer the below
questions:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Which Soccer team have improved the most over the period of time?
\item
  Which Soccer Player has the best rating for penalties?
\item
  Which team attributes lead to most victories?
\item
  Is refree partial towards home team during a match?
\item
  What are the chances of away team winning a game, even after
  committing more fouls than home team?
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{import all necessary libs for data processing.}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{xml}\PY{n+nn}{.}\PY{n+nn}{etree}\PY{n+nn}{.}\PY{n+nn}{ElementTree} \PY{k}{as} \PY{n+nn}{ET}
        \PY{k+kn}{import} \PY{n+nn}{sqlite3} \PY{k}{as} \PY{n+nn}{db}
        
        \PY{c+c1}{\PYZsh{} Magic word to plot charts in jupyter notebook for exploratory data analysis}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    After exploring the data in SQLite Browser, below queries are created to
gather the data for further exploration.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Compose all the data frames needed for all the above questions.}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} List of SQL Queries used to fetch data from SQLite Db}
        
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{Query \PYZsh{}1: The below query \PYZdq{}match\PYZus{}query\PYZdq{} can be used to get all the information related to Matches.}
        \PY{l+s+sd}{This query will be used for answering Questions \PYZsh{}1, \PYZsh{}3, \PYZsh{}4, \PYZsh{}5}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{match\PYZus{}query} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{select }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{M.match\PYZus{}api\PYZus{}id as match\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.date as match\PYZus{}date }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.league\PYZus{}id as league\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,L.name as league\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.stage as match\PYZus{}stage }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,C.name as country\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.season as season }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,HT.team\PYZus{}long\PYZus{}name as home\PYZus{}team\PYZus{}long\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.home\PYZus{}team\PYZus{}api\PYZus{}id as  home\PYZus{}team\PYZus{}api\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,HT.team\PYZus{}short\PYZus{}name as home\PYZus{}team\PYZus{}short\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,AT.team\PYZus{}long\PYZus{}name as away\PYZus{}team\PYZus{}long\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.away\PYZus{}team\PYZus{}api\PYZus{}id as away\PYZus{}team\PYZus{}api\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,AT.team\PYZus{}short\PYZus{}name as away\PYZus{}team\PYZus{}short\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.home\PYZus{}team\PYZus{}goal as home\PYZus{}team\PYZus{}goals }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.away\PYZus{}team\PYZus{}goal as away\PYZus{}team\PYZus{}goals }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.shoton }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.shotoff }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.corner }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.foulcommit }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.card }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.cross }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,M.possession }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{from Match as M }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{join League as L on M.league\PYZus{}id = L.id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{join Country as C on C.id = L.country\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{join Team as HT on HT.team\PYZus{}api\PYZus{}id = M.home\PYZus{}team\PYZus{}api\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{join Team as AT on AT.team\PYZus{}api\PYZus{}id = M.away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{Query \PYZsh{}2: Below Query \PYZsq{}player\PYZus{}query\PYZsq{} could be used to get the Player Attributes.}
        \PY{l+s+sd}{Also, there are multiple attributes associated with Player, we filtered to get penalties to answer question \PYZsh{}2}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        
        \PY{n}{player\PYZus{}query} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{select }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{P.Player\PYZus{}api\PYZus{}id as player\PYZus{}api\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,P.player\PYZus{}name as player\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.date as rating\PYZus{}date }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.penalties as penalties }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.overall\PYZus{}rating }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.attacking\PYZus{}work\PYZus{}rate }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.potential }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.finishing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.heading\PYZus{}accuracy }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.short\PYZus{}passing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.volleys }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.dribbling }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.curve }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.free\PYZus{}kick\PYZus{}accuracy }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.long\PYZus{}passing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.ball\PYZus{}control }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.acceleration }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.sprint\PYZus{}speed }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.agility }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.reactions }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.balance }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.shot\PYZus{}power }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.jumping }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.stamina }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.strength }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.long\PYZus{}shots }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.aggression }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.positioning }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.vision }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{,PA.marking }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{from Player as P }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{inner join Player\PYZus{}Attributes as PA  }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{on P.player\PYZus{}api\PYZus{}id = PA.player\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{Query \PYZsh{}3: Below query \PYZsq{}team\PYZus{}query\PYZsq{} could be used for getting team attributes.}
        \PY{l+s+sd}{This query will be used to answer question \PYZsh{}3}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{team\PYZus{}query} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{select }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{T.team\PYZus{}api\PYZus{}id as team\PYZus{}api\PYZus{}id }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, T.team\PYZus{}long\PYZus{}name as team\PYZus{}long\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, T.team\PYZus{}short\PYZus{}name as team\PYZus{}short\PYZus{}name }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.date as rating\PYZus{}date }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlaySpeed as buildup\PYZus{}speed }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlaySpeedClass as buildup\PYZus{}speed\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlayDribbling as buildup\PYZus{}play\PYZus{}dribbling }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlayDribblingClass as buildup\PYZus{}play\PYZus{}dribbling\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlayPassing as buildup\PYZus{}play\PYZus{}passing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlayPassingClass as buildup\PYZus{}play\PYZus{}passing\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.buildUpPlayPositioningClass as buildup\PYZus{}play\PYZus{}positioning\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationPassing as chance\PYZus{}creation\PYZus{}passing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationPassingClass as chance\PYZus{}creation\PYZus{}passing\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationCrossing as chance\PYZus{}creation\PYZus{}crossing }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationCrossingClass as chance\PYZus{}creation\PYZus{}crossing\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationShooting as chance\PYZus{}creation\PYZus{}shooting }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationShootingClass as chance\PYZus{}creation\PYZus{}shooting\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.chanceCreationPositioningClass as chance\PYZus{}creation\PYZus{}positioning\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defencePressure as defence\PYZus{}pressure }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defencePressureClass as defence\PYZus{}pressure\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defenceAggression  as defence\PYZus{}aggression }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defenceAggressionClass as defence\PYZus{}aggresion\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defenceTeamWidth as defence\PYZus{}team\PYZus{}width }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defenceTeamWidthClass as defence\PYZus{}width\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{, TA.defenceDefenderLineClass as defence\PYZus{}defender\PYZus{}line\PYZus{}class }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{from Team as T }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{join Team\PYZus{}Attributes as TA }\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{on T.team\PYZus{}api\PYZus{}id = TA.team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


     \#\# Data Wrangling

\hypertarget{gathering-data}{%
\subsubsection{Gathering Data}\label{gathering-data}}

    Using the above queries, lets connect to the Sqlite DB and get the data
we need into dataframes for further analyses.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Connect to the database}
        \PY{n}{conn} \PY{o}{=} \PY{n}{db}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{database.sqlite}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}Create match dataframe with match query}
        \PY{n}{df\PYZus{}match} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{n}{match\PYZus{}query}\PY{p}{,} \PY{n}{conn}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}create player dataframe with player query}
        \PY{n}{df\PYZus{}player} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{n}{player\PYZus{}query}\PY{p}{,} \PY{n}{conn}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}create team dataframe with team query}
        \PY{n}{df\PYZus{}team} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{n}{team\PYZus{}query}\PY{p}{,} \PY{n}{conn}\PY{p}{)}
\end{Verbatim}


    \hypertarget{general-properties}{%
\subsubsection{General Properties}\label{general-properties}}

Verify the dataframes to make sure all the data have been populated in
right manner

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Verify Match Dataframe \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}    match\_id           match\_date  league\_id             league\_name  \textbackslash{}
        0    492473  2008-08-17 00:00:00          1  Belgium Jupiler League   
        1    492474  2008-08-16 00:00:00          1  Belgium Jupiler League   
        2    492475  2008-08-16 00:00:00          1  Belgium Jupiler League   
        3    492476  2008-08-17 00:00:00          1  Belgium Jupiler League   
        4    492477  2008-08-16 00:00:00          1  Belgium Jupiler League   
        
           match\_stage country\_name     season home\_team\_long\_name  home\_team\_api\_id  \textbackslash{}
        0            1      Belgium  2008/2009            KRC Genk              9987   
        1            1      Belgium  2008/2009    SV Zulte-Waregem             10000   
        2            1      Belgium  2008/2009   KSV Cercle Brugge              9984   
        3            1      Belgium  2008/2009            KAA Gent              9991   
        4            1      Belgium  2008/2009       FCV Dender EH              7947   
        
          home\_team\_short\_name    {\ldots}     away\_team\_short\_name  home\_team\_goals  \textbackslash{}
        0                  GEN    {\ldots}                      BAC                1   
        1                  ZUL    {\ldots}                      LOK                0   
        2                  CEB    {\ldots}                      AND                0   
        3                  GEN    {\ldots}                      MON                5   
        4                  DEN    {\ldots}                      STL                1   
        
          away\_team\_goals  shoton  shotoff corner foulcommit  card cross possession  
        0               1    None     None   None       None  None  None       None  
        1               0    None     None   None       None  None  None       None  
        2               3    None     None   None       None  None  None       None  
        3               0    None     None   None       None  None  None       None  
        4               3    None     None   None       None  None  None       None  
        
        [5 rows x 22 columns]
\end{Verbatim}
            
    \hypertarget{which-match-attributes-can-help-answer-which-questions}{%
\paragraph{Which Match Attributes can help answer which
questions?}\label{which-match-attributes-can-help-answer-which-questions}}

\textbf{1. Question 1: which team have improved over a period of time?}

Match Id, Season, Team Ids, Team Goals =\textgreater{} attributes can
help determine which team won during every match which can be used to
find whether the team have improved or not.

\textbf{2. Question 3: which team attributes lead to most victories?}

To answer the above question, team who most of the matches in every
season needs to be calculated. Match Attributes like Match Id, Team Ids,
Goals will help determine whether a team won or not. This could be
further used to get the team attributes.

\textbf{3. Question 4: Is refree partial towards a home team during a
match?}

To answer the above question, match attributes like foulcommit, card can
be helpful.

\textbf{4. Question 5: What are the chances of away team winning a game,
even after committing more fouls than home team?}

To answer the above question, we need to whether an away team have the
match or not along with foulcommit information

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Verify Player DataFrame\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}    player\_api\_id         player\_name          rating\_date  penalties  \textbackslash{}
        0         505942  Aaron Appindangoye  2016-02-18 00:00:00       48.0   
        1         505942  Aaron Appindangoye  2015-11-19 00:00:00       48.0   
        2         505942  Aaron Appindangoye  2015-09-21 00:00:00       48.0   
        3         505942  Aaron Appindangoye  2015-03-20 00:00:00       47.0   
        4         505942  Aaron Appindangoye  2007-02-22 00:00:00       47.0   
        
           overall\_rating attacking\_work\_rate  potential  finishing  heading\_accuracy  \textbackslash{}
        0            67.0              medium       71.0       44.0              71.0   
        1            67.0              medium       71.0       44.0              71.0   
        2            62.0              medium       66.0       44.0              71.0   
        3            61.0              medium       65.0       43.0              70.0   
        4            61.0              medium       65.0       43.0              70.0   
        
           short\_passing   {\ldots}     balance  shot\_power  jumping  stamina  strength  \textbackslash{}
        0           61.0   {\ldots}        65.0        55.0     58.0     54.0      76.0   
        1           61.0   {\ldots}        65.0        55.0     58.0     54.0      76.0   
        2           61.0   {\ldots}        65.0        55.0     58.0     54.0      76.0   
        3           60.0   {\ldots}        65.0        54.0     58.0     54.0      76.0   
        4           60.0   {\ldots}        65.0        54.0     58.0     54.0      76.0   
        
           long\_shots  aggression  positioning  vision  marking  
        0        35.0        71.0         45.0    54.0     65.0  
        1        35.0        71.0         45.0    54.0     65.0  
        2        35.0        63.0         45.0    54.0     65.0  
        3        34.0        62.0         44.0    53.0     62.0  
        4        34.0        62.0         44.0    53.0     62.0  
        
        [5 rows x 30 columns]
\end{Verbatim}
            
    \hypertarget{which-player-attributes-can-be-helpful-to-answer-questions-we-have}{%
\paragraph{Which Player attributes can be helpful to answer questions we
have?}\label{which-player-attributes-can-be-helpful-to-answer-questions-we-have}}

\textbf{Question 2: Which Soccer Player has the best rating for
penalties?}

Since we are interested only in Penalties, the following attributes
could be helpful: Player ID, Player Name, Rating Date, Penalties.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Verify Team Data Frame\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}    team\_api\_id team\_long\_name team\_short\_name          rating\_date  \textbackslash{}
        0         9930       FC Aarau             AAR  2010-02-22 00:00:00   
        1         9930       FC Aarau             AAR  2014-09-19 00:00:00   
        2         9930       FC Aarau             AAR  2015-09-10 00:00:00   
        3         8485       Aberdeen             ABE  2010-02-22 00:00:00   
        4         8485       Aberdeen             ABE  2011-02-22 00:00:00   
        
           buildup\_speed buildup\_speed\_class  buildup\_play\_dribbling  \textbackslash{}
        0             60            Balanced                     NaN   
        1             52            Balanced                    48.0   
        2             47            Balanced                    41.0   
        3             70                Fast                     NaN   
        4             47            Balanced                     NaN   
        
          buildup\_play\_dribbling\_class  buildup\_play\_passing  \textbackslash{}
        0                       Little                    50   
        1                       Normal                    56   
        2                       Normal                    54   
        3                       Little                    70   
        4                       Little                    52   
        
          buildup\_play\_passing\_class             {\ldots}              \textbackslash{}
        0                      Mixed             {\ldots}               
        1                      Mixed             {\ldots}               
        2                      Mixed             {\ldots}               
        3                       Long             {\ldots}               
        4                      Mixed             {\ldots}               
        
          chance\_creation\_shooting  chance\_creation\_shooting\_class  \textbackslash{}
        0                       55                          Normal   
        1                       64                          Normal   
        2                       64                          Normal   
        3                       70                            Lots   
        4                       52                          Normal   
        
          chance\_creation\_positioning\_class  defence\_pressure defence\_pressure\_class  \textbackslash{}
        0                         Organised                50                 Medium   
        1                         Organised                47                 Medium   
        2                         Organised                47                 Medium   
        3                         Organised                60                 Medium   
        4                         Organised                47                 Medium   
        
           defence\_aggression defence\_aggresion\_class defence\_team\_width  \textbackslash{}
        0                  55                   Press                 45   
        1                  44                   Press                 54   
        2                  44                   Press                 54   
        3                  70                  Double                 70   
        4                  47                   Press                 52   
        
           defence\_width\_class defence\_defender\_line\_class  
        0               Normal                       Cover  
        1               Normal                       Cover  
        2               Normal                       Cover  
        3                 Wide                       Cover  
        4               Normal                       Cover  
        
        [5 rows x 25 columns]
\end{Verbatim}
            
    \hypertarget{which-team-attributes-can-be-helpful-to-answer-questions-we-have}{%
\paragraph{Which Team attributes can be helpful to answer questions we
have?}\label{which-team-attributes-can-be-helpful-to-answer-questions-we-have}}

\textbf{Question 3: Which team attributes lead to most victories?}

Most of team attributes like `Buildup Play Speed Class', `Defence
Aggression Class',etc., can be helpful

    \hypertarget{data-cleaning---match-attributes}{%
\subsubsection{Data Cleaning - Match
Attributes}\label{data-cleaning---match-attributes}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} First Explore the Dataframe columns and its datatype\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 25979 entries, 0 to 25978
Data columns (total 22 columns):
match\_id                25979 non-null int64
match\_date              25979 non-null object
league\_id               25979 non-null int64
league\_name             25979 non-null object
match\_stage             25979 non-null int64
country\_name            25979 non-null object
season                  25979 non-null object
home\_team\_long\_name     25979 non-null object
home\_team\_api\_id        25979 non-null int64
home\_team\_short\_name    25979 non-null object
away\_team\_long\_name     25979 non-null object
away\_team\_api\_id        25979 non-null int64
away\_team\_short\_name    25979 non-null object
home\_team\_goals         25979 non-null int64
away\_team\_goals         25979 non-null int64
shoton                  14217 non-null object
shotoff                 14217 non-null object
corner                  14217 non-null object
foulcommit              14217 non-null object
card                    14217 non-null object
cross                   14217 non-null object
possession              14217 non-null object
dtypes: int64(7), object(15)
memory usage: 4.4+ MB

    \end{Verbatim}

    \textbf{Looking at the above dataframe, the following steps needs to be
taken care:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \emph{`match\_date'} is considered as string datatype.
\item
  Match attributes like \emph{`shoton', `shotoff', `corner',
  `foulcommit', `card', `cross', `possession'} are in XML format. This
  needs to be futher processed to get meaningful insights.
\item
  Check if they have duplicates.
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Convert Match Date Data Type\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    There are matches played in early part of the year, and end part of the
year. Its difficult to use match date to group the matches played in a
season. We can split the season(START YEAR/END YEAR) to get some group.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}end}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{str}
        \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
        \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}end}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}end}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\end{Verbatim}


    \textbf{XML Data Convertion}

Generic XML Parser Class is created to convert XML to Dataframe to get
meaningful insights.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{The below code is copied from here: }
         \PY{l+s+sd}{http://www.austintaylor.io/lxml/python/pandas/xml/dataframe/2016/07/08/convert\PYZhy{}xml\PYZhy{}to\PYZhy{}pandas\PYZhy{}dataframe/}
         \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{class} \PY{n+nc}{XML2DataFrame}\PY{p}{:}
         
             \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{xml\PYZus{}data}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{root} \PY{o}{=} \PY{n}{ET}\PY{o}{.}\PY{n}{XML}\PY{p}{(}\PY{n}{xml\PYZus{}data}\PY{p}{)}
         
             \PY{k}{def} \PY{n+nf}{parse\PYZus{}root}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{root}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return a list of dictionaries from the text}
         \PY{l+s+sd}{         and attributes of the children under this XML root.\PYZdq{}\PYZdq{}\PYZdq{}}
                 \PY{k}{return} \PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{parse\PYZus{}element}\PY{p}{(}\PY{n}{child}\PY{p}{)} \PY{k}{for} \PY{n}{child} \PY{o+ow}{in} \PY{n+nb}{iter}\PY{p}{(}\PY{n}{root}\PY{p}{)}\PY{p}{]}
         
             \PY{k}{def} \PY{n+nf}{parse\PYZus{}element}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{element}\PY{p}{,} \PY{n}{parsed}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Collect \PYZob{}key:attribute\PYZcb{} and \PYZob{}tag:text\PYZcb{} from thie XML}
         \PY{l+s+sd}{        element and all its children into a single dictionary of strings.\PYZdq{}\PYZdq{}\PYZdq{}}
                 
                 \PY{k}{if} \PY{n}{parsed} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                     \PY{n}{parsed} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
                 \PY{k}{for} \PY{n}{key} \PY{o+ow}{in} \PY{n}{element}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                     \PY{n}{parsed}\PY{p}{[}\PY{n}{key}\PY{p}{]} \PY{o}{=} \PY{n}{element}\PY{o}{.}\PY{n}{attrib}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{key}\PY{p}{)}
                 \PY{k}{if} \PY{n}{element}\PY{o}{.}\PY{n}{text}\PY{p}{:}
                     \PY{n}{parsed}\PY{p}{[}\PY{n}{element}\PY{o}{.}\PY{n}{tag}\PY{p}{]} \PY{o}{=} \PY{n}{element}\PY{o}{.}\PY{n}{text}
                     
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Apply recursion\PYZdq{}\PYZdq{}\PYZdq{}}
                 \PY{k}{for} \PY{n}{child} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{element}\PY{p}{)}\PY{p}{:}
                     \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{parse\PYZus{}element}\PY{p}{(}\PY{n}{child}\PY{p}{,} \PY{n}{parsed}\PY{p}{)}
                 \PY{k}{return} \PY{n}{parsed}
         
             \PY{k}{def} \PY{n+nf}{process\PYZus{}data}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Initiate the root XML, parse it, and return a dataframe\PYZdq{}\PYZdq{}\PYZdq{}}
                 \PY{n}{structure\PYZus{}data} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{parse\PYZus{}root}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{root}\PY{p}{)}
                 \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{structure\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    Since each attribute has XML formats in a unique way, a generic function
is needed to handle each attribute.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} This function takes the dataframe and a name of the column to be parsed\PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{def} \PY{n+nf}{parse\PYZus{}xml\PYZus{}data}\PY{p}{(}\PY{n}{dataFrame}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}    
             
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Handle Empty Cells\PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{if} \PY{n}{dataFrame}\PY{p}{[}\PY{n}{colName}\PY{p}{]} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                 \PY{k}{if} \PY{n}{colName} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{corner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{possession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                     \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{)}
                 \PY{k}{elif} \PY{n}{colName} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{card}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                     \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unknown column to parse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
             
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Get the data from the column and convert it to Dataframe \PYZdq{}\PYZdq{}\PYZdq{}}    
             \PY{n}{xml2df} \PY{o}{=} \PY{n}{XML2DataFrame}\PY{p}{(}\PY{n}{dataFrame}\PY{p}{[}\PY{n}{colName}\PY{p}{]}\PY{p}{)}
             \PY{n}{xml\PYZus{}dataframe} \PY{o}{=} \PY{n}{xml2df}\PY{o}{.}\PY{n}{process\PYZus{}data}\PY{p}{(}\PY{p}{)}
         
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Gather the Home and Away ID \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{home\PYZus{}team\PYZus{}api\PYZus{}id} \PY{o}{=} \PY{n}{dataFrame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{away\PYZus{}team\PYZus{}api\PYZus{}id} \PY{o}{=} \PY{n}{dataFrame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}                    
         
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Process \PYZsq{}corner\PYZsq{}, \PYZsq{}shoton\PYZsq{}, \PYZsq{}shotoff\PYZsq{}, \PYZsq{}foulcommit\PYZsq{} columns\PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{if} \PY{n}{colName} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{corner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Initialize the return data \PYZdq{}\PYZdq{}\PYZdq{}}
                 \PY{n}{series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{)}
                 \PY{k}{try}\PY{p}{:}  
                     \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Check if team column is in parsed dataframe \PYZdq{}\PYZdq{}\PYZdq{}}
                     \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
                         \PY{n}{data\PYZus{}values} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                         \PY{n}{data\PYZus{}values}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}values}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} 
         
                         \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{data\PYZus{}values}\PY{p}{[}\PY{n}{data\PYZus{}values}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                         \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{data\PYZus{}values}\PY{p}{[}\PY{n}{data\PYZus{}values}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                         \PY{n}{series} \PY{o}{=}  \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}  \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}      
                                              \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}                
                 \PY{k}{except}\PY{p}{:}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ : }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s1}{ Problematic Index}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n}{colName}\PY{p}{,} \PY{n}{dataFrame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{series}
             \PY{k}{elif} \PY{n}{colName} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{possession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{)}
                 \PY{k}{try}\PY{p}{:}
                     \PY{k}{if} \PY{n+nb}{set}\PY{p}{(}\PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{issuperset}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{awaypos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{homepos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elapsed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{p}{:}  
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} There could be data where elapsed time is not 90.. }
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} We need to highest elapsed and parse the data.}
                         \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} }
         \PY{l+s+sd}{                During some data exploration phase, we have identified, that some matches possession data is not available for the entire.}
         \PY{l+s+sd}{                In the below logic, we try to sort the possession data available for the highest elapsed time and get their data.    }
         \PY{l+s+sd}{                \PYZdq{}\PYZdq{}\PYZdq{}}
                         \PY{n}{xml\PYZus{}dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elapsed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elapsed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
                         \PY{n}{row\PYZus{}with\PYZus{}max\PYZus{}elapsed} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elapsed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)}                    
                         \PY{n}{homepossesion\PYZus{}time} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row\PYZus{}with\PYZus{}max\PYZus{}elapsed}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{homepos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
                         \PY{n}{awaypossesion\PYZus{}time} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row\PYZus{}with\PYZus{}max\PYZus{}elapsed}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{awaypos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
                         \PY{n}{series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{n}{homepossesion\PYZus{}time}\PY{p}{,} \PY{n}{awaypossesion\PYZus{}time}\PY{p}{]}\PY{p}{)}   
         
                 \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
                         \PY{c+c1}{\PYZsh{}print(e)}
                         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ : }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s1}{ Problematic Index}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n}{colName}\PY{p}{,} \PY{n}{dataFrame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{series}
             \PY{k}{elif} \PY{n}{colName} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{card}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}            
                 \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} For card column, we would like to get the data in this format }
         \PY{l+s+sd}{        (\PYZsq{}home team yellow card\PYZsq{}, \PYZsq{}away team yellow card\PYZsq{}, \PYZsq{}home team red card\PYZsq{}, \PYZsq{}away team red card\PYZsq{} )\PYZdq{}\PYZdq{}\PYZdq{}}
                 \PY{n}{series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{)}
         
                 \PY{k}{try}\PY{p}{:}                
                     \PY{k}{if} \PY{n+nb}{set}\PY{p}{(}\PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{issuperset}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{:}                    
                         \PY{n}{yCard\PYZus{}frame} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)} 
                         \PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} 
         
                         \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{p}{(}\PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                         \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{p}{(}\PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{yCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}                   
         
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
                         \PY{c+c1}{\PYZsh{}update red card 0 for now, rather than None, as red card is not issued in all the matches.}
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
         
                     \PY{k}{if} \PY{n+nb}{set}\PY{p}{(}\PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{issuperset}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rcards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{:}
         
                         \PY{n}{rCard\PYZus{}frame} \PY{o}{=} \PY{n}{xml\PYZus{}dataframe}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rcards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
                         \PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} 
                         \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{p}{(}\PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rcards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                         \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value} \PY{o}{=} \PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{p}{(}\PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{rCard\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rcards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}                   
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{home\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{series}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0} \PY{k}{if} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n}{away\PYZus{}team\PYZus{}data\PYZus{}value}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}                 
         
                     \PY{k}{return} \PY{n}{series}
         
                 \PY{k}{except}\PY{p}{:}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ : }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s1}{ Problematic Index}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n}{colName}\PY{p}{,} \PY{n}{dataFrame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                     \PY{k}{return} \PY{n}{series}
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unknown column to parse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Now parse all the XML data columns and assign it to new column\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{c+c1}{\PYZsh{}shoton}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}shotoff}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}corners}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}corners}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}corners}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{corner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}foulcommits}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}possession}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}possesion}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}possession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{possession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}card \PYZhy{} yellow and red cards}
         \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{parse\PYZus{}xml\PYZus{}data}\PY{p}{,} \PY{n}{colName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{card}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    Check if everything have parsed successfully.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 25979 entries, 0 to 25978
Data columns (total 38 columns):
match\_id                25979 non-null int64
match\_date              25979 non-null datetime64[ns]
league\_id               25979 non-null int64
league\_name             25979 non-null object
match\_stage             25979 non-null int64
country\_name            25979 non-null object
season                  25979 non-null object
home\_team\_long\_name     25979 non-null object
home\_team\_api\_id        25979 non-null int64
home\_team\_short\_name    25979 non-null object
away\_team\_long\_name     25979 non-null object
away\_team\_api\_id        25979 non-null int64
away\_team\_short\_name    25979 non-null object
home\_team\_goals         25979 non-null int64
away\_team\_goals         25979 non-null int64
shoton                  14217 non-null object
shotoff                 14217 non-null object
corner                  14217 non-null object
foulcommit              14217 non-null object
card                    14217 non-null object
cross                   14217 non-null object
possession              14217 non-null object
season\_start            25979 non-null int32
season\_end              25979 non-null int32
home\_team\_shoton        8463 non-null float64
away\_team\_shoton        8463 non-null float64
home\_team\_shotoff       8463 non-null float64
away\_team\_shotoff       8463 non-null float64
home\_team\_corners       8464 non-null float64
away\_team\_corners       8464 non-null float64
home\_team\_foulcommit    8465 non-null float64
away\_team\_foulcommit    8465 non-null float64
home\_team\_possesion     8417 non-null object
away\_team\_possession    8417 non-null object
home\_team\_ycard         13752 non-null float64
away\_team\_ycard         13752 non-null float64
home\_team\_rcard         13772 non-null float64
away\_team\_rcard         13772 non-null float64
dtypes: datetime64[ns](1), float64(12), int32(2), int64(7), object(16)
memory usage: 7.3+ MB

    \end{Verbatim}

    Drop the XML columns, as we have all the XMLs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shoton}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shotoff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{corner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{card}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cross}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{possession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    Save the data in Json file for later use, as XML Data computation is
heavy.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{to\PYZus{}json}\PY{p}{(}\PY{n}{path\PYZus{}or\PYZus{}buf}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}data.json}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{records}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    Read the dataframe from the Json file.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{df\PYZus{}match} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}json}\PY{p}{(}\PY{n}{path\PYZus{}or\PYZus{}buf}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}data.json}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{records}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 25979 entries, 0 to 25978
Data columns (total 31 columns):
away\_team\_api\_id        25979 non-null int64
away\_team\_corners       8464 non-null float64
away\_team\_foulcommit    8465 non-null float64
away\_team\_goals         25979 non-null int64
away\_team\_long\_name     25979 non-null object
away\_team\_possession    8417 non-null float64
away\_team\_rcard         13772 non-null float64
away\_team\_short\_name    25979 non-null object
away\_team\_shotoff       8463 non-null float64
away\_team\_shoton        8463 non-null float64
away\_team\_ycard         13752 non-null float64
country\_name            25979 non-null object
home\_team\_api\_id        25979 non-null int64
home\_team\_corners       8464 non-null float64
home\_team\_foulcommit    8465 non-null float64
home\_team\_goals         25979 non-null int64
home\_team\_long\_name     25979 non-null object
home\_team\_possesion     8417 non-null float64
home\_team\_rcard         13772 non-null float64
home\_team\_short\_name    25979 non-null object
home\_team\_shotoff       8463 non-null float64
home\_team\_shoton        8463 non-null float64
home\_team\_ycard         13752 non-null float64
league\_id               25979 non-null int64
league\_name             25979 non-null object
match\_date              25979 non-null int64
match\_id                25979 non-null int64
match\_stage             25979 non-null int64
season                  25979 non-null object
season\_end              25979 non-null int64
season\_start            25979 non-null int64
dtypes: float64(14), int64(10), object(7)
memory usage: 6.1+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 25979 entries, 0 to 25978
Data columns (total 31 columns):
away\_team\_api\_id        25979 non-null int64
away\_team\_corners       8464 non-null float64
away\_team\_foulcommit    8465 non-null float64
away\_team\_goals         25979 non-null int64
away\_team\_long\_name     25979 non-null object
away\_team\_possession    8417 non-null float64
away\_team\_rcard         13772 non-null float64
away\_team\_short\_name    25979 non-null object
away\_team\_shotoff       8463 non-null float64
away\_team\_shoton        8463 non-null float64
away\_team\_ycard         13752 non-null float64
country\_name            25979 non-null object
home\_team\_api\_id        25979 non-null int64
home\_team\_corners       8464 non-null float64
home\_team\_foulcommit    8465 non-null float64
home\_team\_goals         25979 non-null int64
home\_team\_long\_name     25979 non-null object
home\_team\_possesion     8417 non-null float64
home\_team\_rcard         13772 non-null float64
home\_team\_short\_name    25979 non-null object
home\_team\_shotoff       8463 non-null float64
home\_team\_shoton        8463 non-null float64
home\_team\_ycard         13752 non-null float64
league\_id               25979 non-null int64
league\_name             25979 non-null object
match\_date              25979 non-null datetime64[ns]
match\_id                25979 non-null int64
match\_stage             25979 non-null int64
season                  25979 non-null object
season\_end              25979 non-null int64
season\_start            25979 non-null int64
dtypes: datetime64[ns](1), float64(14), int64(9), object(7)
memory usage: 6.1+ MB

    \end{Verbatim}

    Let's not drop all the null values in match attributes columns like
shot\_on, shot\_off, foulcommit, possession, cards, as we can determine
the match win by using `home\_team\_goals', `away\_team\_goals'. This
could be helpful in looking at team's improvement.

    Now, Lets check for duplicates

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} 0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} (25979, 31)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{df\PYZus{}match}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} 25979
\end{Verbatim}
            
    \hypertarget{data-cleaning---player-attributes}{%
\subsubsection{Data Cleaning - Player
Attributes}\label{data-cleaning---player-attributes}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 183978 entries, 0 to 183977
Data columns (total 30 columns):
player\_api\_id          183978 non-null int64
player\_name            183978 non-null object
rating\_date            183978 non-null object
penalties              183142 non-null float64
overall\_rating         183142 non-null float64
attacking\_work\_rate    180748 non-null object
potential              183142 non-null float64
finishing              183142 non-null float64
heading\_accuracy       183142 non-null float64
short\_passing          183142 non-null float64
volleys                181265 non-null float64
dribbling              183142 non-null float64
curve                  181265 non-null float64
free\_kick\_accuracy     183142 non-null float64
long\_passing           183142 non-null float64
ball\_control           183142 non-null float64
acceleration           183142 non-null float64
sprint\_speed           183142 non-null float64
agility                181265 non-null float64
reactions              183142 non-null float64
balance                181265 non-null float64
shot\_power             183142 non-null float64
jumping                181265 non-null float64
stamina                183142 non-null float64
strength               183142 non-null float64
long\_shots             183142 non-null float64
aggression             183142 non-null float64
positioning            183142 non-null float64
vision                 181265 non-null float64
marking                183142 non-null float64
dtypes: float64(26), int64(1), object(3)
memory usage: 42.1+ MB

    \end{Verbatim}

    Looking at the information above, the below steps need to be taken for
data cleaning. 1. convert the `rating\_date' datatype from string to
datetime 2. check for duplicate records.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{df\PYZus{}player}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df\PYZus{}player}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} 1
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Validate if the duplicates are removed\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:} 0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 183977 entries, 0 to 183977
Data columns (total 30 columns):
player\_api\_id          183977 non-null int64
player\_name            183977 non-null object
rating\_date            183977 non-null datetime64[ns]
penalties              183142 non-null float64
overall\_rating         183142 non-null float64
attacking\_work\_rate    180748 non-null object
potential              183142 non-null float64
finishing              183142 non-null float64
heading\_accuracy       183142 non-null float64
short\_passing          183142 non-null float64
volleys                181265 non-null float64
dribbling              183142 non-null float64
curve                  181265 non-null float64
free\_kick\_accuracy     183142 non-null float64
long\_passing           183142 non-null float64
ball\_control           183142 non-null float64
acceleration           183142 non-null float64
sprint\_speed           183142 non-null float64
agility                181265 non-null float64
reactions              183142 non-null float64
balance                181265 non-null float64
shot\_power             183142 non-null float64
jumping                181265 non-null float64
stamina                183142 non-null float64
strength               183142 non-null float64
long\_shots             183142 non-null float64
aggression             183142 non-null float64
positioning            183142 non-null float64
vision                 181265 non-null float64
marking                183142 non-null float64
dtypes: datetime64[ns](1), float64(26), int64(1), object(2)
memory usage: 43.5+ MB

    \end{Verbatim}

    Remove the null data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 180354 entries, 0 to 183977
Data columns (total 30 columns):
player\_api\_id          180354 non-null int64
player\_name            180354 non-null object
rating\_date            180354 non-null datetime64[ns]
penalties              180354 non-null float64
overall\_rating         180354 non-null float64
attacking\_work\_rate    180354 non-null object
potential              180354 non-null float64
finishing              180354 non-null float64
heading\_accuracy       180354 non-null float64
short\_passing          180354 non-null float64
volleys                180354 non-null float64
dribbling              180354 non-null float64
curve                  180354 non-null float64
free\_kick\_accuracy     180354 non-null float64
long\_passing           180354 non-null float64
ball\_control           180354 non-null float64
acceleration           180354 non-null float64
sprint\_speed           180354 non-null float64
agility                180354 non-null float64
reactions              180354 non-null float64
balance                180354 non-null float64
shot\_power             180354 non-null float64
jumping                180354 non-null float64
stamina                180354 non-null float64
strength               180354 non-null float64
long\_shots             180354 non-null float64
aggression             180354 non-null float64
positioning            180354 non-null float64
vision                 180354 non-null float64
marking                180354 non-null float64
dtypes: datetime64[ns](1), float64(26), int64(1), object(2)
memory usage: 42.7+ MB

    \end{Verbatim}

    \hypertarget{data-cleaning---team-attributes}{%
\subsubsection{Data Cleaning - Team
Attributes}\label{data-cleaning---team-attributes}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1458 entries, 0 to 1457
Data columns (total 25 columns):
team\_api\_id                          1458 non-null int64
team\_long\_name                       1458 non-null object
team\_short\_name                      1458 non-null object
rating\_date                          1458 non-null object
buildup\_speed                        1458 non-null int64
buildup\_speed\_class                  1458 non-null object
buildup\_play\_dribbling               489 non-null float64
buildup\_play\_dribbling\_class         1458 non-null object
buildup\_play\_passing                 1458 non-null int64
buildup\_play\_passing\_class           1458 non-null object
buildup\_play\_positioning\_class       1458 non-null object
chance\_creation\_passing              1458 non-null int64
chance\_creation\_passing\_class        1458 non-null object
chance\_creation\_crossing             1458 non-null int64
chance\_creation\_crossing\_class       1458 non-null object
chance\_creation\_shooting             1458 non-null int64
chance\_creation\_shooting\_class       1458 non-null object
chance\_creation\_positioning\_class    1458 non-null object
defence\_pressure                     1458 non-null int64
defence\_pressure\_class               1458 non-null object
defence\_aggression                   1458 non-null int64
defence\_aggresion\_class              1458 non-null object
defence\_team\_width                   1458 non-null int64
defence\_width\_class                  1458 non-null object
defence\_defender\_line\_class          1458 non-null object
dtypes: float64(1), int64(9), object(15)
memory usage: 284.8+ KB

    \end{Verbatim}

    Looking at the above information, we need to following steps.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Convert the rating date from string to datetime datatype
\item
  Filter out unwanted columns
\item
  Remove null data and duplicates.
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{df\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:}    team\_api\_id team\_long\_name team\_short\_name rating\_date  buildup\_speed  \textbackslash{}
         0         9930       FC Aarau             AAR  2010-02-22             60   
         1         9930       FC Aarau             AAR  2014-09-19             52   
         2         9930       FC Aarau             AAR  2015-09-10             47   
         3         8485       Aberdeen             ABE  2010-02-22             70   
         4         8485       Aberdeen             ABE  2011-02-22             47   
         
           buildup\_speed\_class  buildup\_play\_dribbling buildup\_play\_dribbling\_class  \textbackslash{}
         0            Balanced                     NaN                       Little   
         1            Balanced                    48.0                       Normal   
         2            Balanced                    41.0                       Normal   
         3                Fast                     NaN                       Little   
         4            Balanced                     NaN                       Little   
         
            buildup\_play\_passing buildup\_play\_passing\_class  \textbackslash{}
         0                    50                      Mixed   
         1                    56                      Mixed   
         2                    54                      Mixed   
         3                    70                       Long   
         4                    52                      Mixed   
         
                       {\ldots}             chance\_creation\_shooting  \textbackslash{}
         0             {\ldots}                                   55   
         1             {\ldots}                                   64   
         2             {\ldots}                                   64   
         3             {\ldots}                                   70   
         4             {\ldots}                                   52   
         
            chance\_creation\_shooting\_class chance\_creation\_positioning\_class  \textbackslash{}
         0                          Normal                         Organised   
         1                          Normal                         Organised   
         2                          Normal                         Organised   
         3                            Lots                         Organised   
         4                          Normal                         Organised   
         
            defence\_pressure defence\_pressure\_class  defence\_aggression  \textbackslash{}
         0                50                 Medium                  55   
         1                47                 Medium                  44   
         2                47                 Medium                  44   
         3                60                 Medium                  70   
         4                47                 Medium                  47   
         
           defence\_aggresion\_class defence\_team\_width  defence\_width\_class  \textbackslash{}
         0                   Press                 45               Normal   
         1                   Press                 54               Normal   
         2                   Press                 54               Normal   
         3                  Double                 70                 Wide   
         4                   Press                 52               Normal   
         
           defence\_defender\_line\_class  
         0                       Cover  
         1                       Cover  
         2                       Cover  
         3                       Cover  
         4                       Cover  
         
         [5 rows x 25 columns]
\end{Verbatim}
            
    Looking at the above data, It seems all the numerical column is already
classified or categorized into different classes.

For instance, for looking deeper at `Build Up Speed' data, we can draw
the conclusion that any speed between 34 and 66 are considered as
`Balanced', any speed between 20 and 33 are considered as `Slow' and any
speed between 67 and 80 are considered as `Fast'

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} This function takes Numerical Column and Categorized Column to find Min and Max Range\PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{def} \PY{n+nf}{find\PYZus{}min\PYZus{}max}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{numerical\PYZus{}col\PYZus{}name} \PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{categorized\PYZus{}col\PYZus{}name} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
             \PY{n}{df\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{n}{numerical\PYZus{}col\PYZus{}name}\PY{p}{,}\PY{n}{categorized\PYZus{}col\PYZus{}name}\PY{p}{]}\PY{p}{]}   
             \PY{n}{df\PYZus{}group\PYZus{}min} \PY{o}{=} \PY{n}{df\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{categorized\PYZus{}col\PYZus{}name}\PY{p}{)}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}    
             \PY{n}{df\PYZus{}group\PYZus{}max} \PY{o}{=} \PY{n}{df\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{categorized\PYZus{}col\PYZus{}name}\PY{p}{)}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
             \PY{k}{return} \PY{n}{df\PYZus{}group\PYZus{}min}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}group\PYZus{}max}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{n}{categorized\PYZus{}col\PYZus{}name}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{n}{categorized\PYZus{}col\PYZus{}name}\PY{p}{)}
         
         \PY{n}{find\PYZus{}min\PYZus{}max}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{numerical\PYZus{}col\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buildup\PYZus{}speed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{categorized\PYZus{}col\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buildup\PYZus{}speed\PYZus{}class}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:}   buildup\_speed\_class  buildup\_speed\_x  buildup\_speed\_y
         0            Balanced               34               66
         1                Fast               67               80
         2                Slow               20               33
\end{Verbatim}
            
    Same categorization is applied for other attributes. So, we can remove
the unwanted columns

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} Index(['team\_api\_id', 'team\_long\_name', 'team\_short\_name', 'rating\_date',
                'buildup\_speed', 'buildup\_speed\_class', 'buildup\_play\_dribbling',
                'buildup\_play\_dribbling\_class', 'buildup\_play\_passing',
                'buildup\_play\_passing\_class', 'buildup\_play\_positioning\_class',
                'chance\_creation\_passing', 'chance\_creation\_passing\_class',
                'chance\_creation\_crossing', 'chance\_creation\_crossing\_class',
                'chance\_creation\_shooting', 'chance\_creation\_shooting\_class',
                'chance\_creation\_positioning\_class', 'defence\_pressure',
                'defence\_pressure\_class', 'defence\_aggression',
                'defence\_aggresion\_class', 'defence\_team\_width', 'defence\_width\_class',
                'defence\_defender\_line\_class'],
               dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{class\PYZus{}cols\PYZus{}index} \PY{o}{=} \PY{p}{[}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{get\PYZus{}loc}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}class}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{x}\PY{p}{]}
         \PY{n}{class\PYZus{}cols\PYZus{}index}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:} [5, 7, 9, 10, 12, 14, 16, 17, 19, 21, 23, 24]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{team\PYZus{}interesting\PYZus{}cols\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{r\PYZus{}}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,}\PY{n}{class\PYZus{}cols\PYZus{}index}\PY{p}{]}
         \PY{n}{team\PYZus{}interesting\PYZus{}cols\PYZus{}index}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}37}]:} array([ 0,  1,  2,  3,  5,  7,  9, 10, 12, 14, 16, 17, 19, 21, 23, 24])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{df\PYZus{}team} \PY{o}{=} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{team\PYZus{}interesting\PYZus{}cols\PYZus{}index}\PY{p}{]}
         \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:}       team\_api\_id        team\_long\_name team\_short\_name rating\_date  \textbackslash{}
         0            9930              FC Aarau             AAR  2010-02-22   
         1            9930              FC Aarau             AAR  2014-09-19   
         2            9930              FC Aarau             AAR  2015-09-10   
         3            8485              Aberdeen             ABE  2010-02-22   
         4            8485              Aberdeen             ABE  2011-02-22   
         5            8485              Aberdeen             ABE  2012-02-22   
         6            8485              Aberdeen             ABE  2013-09-20   
         7            8485              Aberdeen             ABE  2014-09-19   
         8            8485              Aberdeen             ABE  2015-09-10   
         9            8576            AC Ajaccio             AJA  2010-02-22   
         10           8576            AC Ajaccio             AJA  2011-02-22   
         11           8576            AC Ajaccio             AJA  2012-02-22   
         12           8576            AC Ajaccio             AJA  2013-09-20   
         13           8576            AC Ajaccio             AJA  2014-09-19   
         14           8576            AC Ajaccio             AJA  2015-09-10   
         15           8564                 Milan             ACM  2010-02-22   
         16           8564                 Milan             ACM  2011-02-22   
         17           8564                 Milan             ACM  2012-02-22   
         18           8564                 Milan             ACM  2013-09-20   
         19           8564                 Milan             ACM  2014-09-19   
         20           8564                 Milan             ACM  2015-09-10   
         21          10215  Acadmica de Coimbra             ACA  2010-02-22   
         22          10215  Acadmica de Coimbra             ACA  2011-02-22   
         23          10215  Acadmica de Coimbra             ACA  2012-02-22   
         24          10215  Acadmica de Coimbra             ACA  2013-09-20   
         25          10215  Acadmica de Coimbra             ACA  2014-09-19   
         26          10215  Acadmica de Coimbra             ACA  2015-09-10   
         27          10217          ADO Den Haag             HAA  2010-02-22   
         28          10217          ADO Den Haag             HAA  2011-02-22   
         29          10217          ADO Den Haag             HAA  2012-02-22   
         {\ldots}           {\ldots}                   {\ldots}             {\ldots}         {\ldots}   
         1428         7955       Neuchtel Xamax             XAM  2012-02-22   
         1429         9868  Xerez Club Deportivo             XER  2010-02-22   
         1430         9868  Xerez Club Deportivo             XER  2011-02-22   
         1431         9868  Xerez Club Deportivo             XER  2012-02-22   
         1432         9868  Xerez Club Deportivo             XER  2013-09-20   
         1433        10192        BSC Young Boys              YB  2010-02-22   
         1434        10192        BSC Young Boys              YB  2011-02-22   
         1435        10192        BSC Young Boys              YB  2012-02-22   
         1436        10192        BSC Young Boys              YB  2013-09-20   
         1437        10192        BSC Young Boys              YB  2014-09-19   
         1438        10192        BSC Young Boys              YB  2015-09-10   
         1439         8021        Zagbie Lubin             ZAG  2010-02-22   
         1440         8021        Zagbie Lubin             ZAG  2011-02-22   
         1441         8021        Zagbie Lubin             ZAG  2012-02-22   
         1442         8021        Zagbie Lubin             ZAG  2013-09-20   
         1443         8021        Zagbie Lubin             ZAG  2014-09-19   
         1444         8394         Real Zaragoza             ZAR  2010-02-22   
         1445         8394         Real Zaragoza             ZAR  2011-02-22   
         1446         8394         Real Zaragoza             ZAR  2012-02-22   
         1447         8394         Real Zaragoza             ZAR  2013-09-20   
         1448         8394         Real Zaragoza             ZAR  2014-09-19   
         1449         8394         Real Zaragoza             ZAR  2015-09-10   
         1450         8027     Zawisza Bydgoszcz             ZAW  2014-09-19   
         1451         8027     Zawisza Bydgoszcz             ZAW  2015-09-10   
         1452        10000      SV Zulte-Waregem             ZUL  2010-02-22   
         1453        10000      SV Zulte-Waregem             ZUL  2011-02-22   
         1454        10000      SV Zulte-Waregem             ZUL  2012-02-22   
         1455        10000      SV Zulte-Waregem             ZUL  2013-09-20   
         1456        10000      SV Zulte-Waregem             ZUL  2014-09-19   
         1457        10000      SV Zulte-Waregem             ZUL  2015-09-10   
         
              buildup\_speed\_class buildup\_play\_dribbling\_class  \textbackslash{}
         0               Balanced                       Little   
         1               Balanced                       Normal   
         2               Balanced                       Normal   
         3                   Fast                       Little   
         4               Balanced                       Little   
         5               Balanced                       Little   
         6               Balanced                       Little   
         7               Balanced                       Normal   
         8               Balanced                       Normal   
         9               Balanced                       Little   
         10              Balanced                       Little   
         11              Balanced                       Little   
         12              Balanced                       Little   
         13              Balanced                       Normal   
         14              Balanced                       Normal   
         15              Balanced                       Little   
         16              Balanced                       Little   
         17              Balanced                       Little   
         18              Balanced                       Little   
         19              Balanced                         Lots   
         20              Balanced                         Lots   
         21                  Slow                       Little   
         22                  Slow                       Little   
         23              Balanced                       Little   
         24              Balanced                       Little   
         25              Balanced                       Normal   
         26              Balanced                       Normal   
         27                  Slow                       Little   
         28              Balanced                       Little   
         29              Balanced                       Little   
         {\ldots}                  {\ldots}                          {\ldots}   
         1428            Balanced                       Little   
         1429                Slow                       Little   
         1430            Balanced                       Little   
         1431            Balanced                       Little   
         1432            Balanced                       Little   
         1433            Balanced                       Little   
         1434            Balanced                       Little   
         1435            Balanced                       Little   
         1436            Balanced                       Little   
         1437            Balanced                       Normal   
         1438            Balanced                       Normal   
         1439            Balanced                       Little   
         1440            Balanced                       Little   
         1441                Slow                       Little   
         1442                Slow                       Little   
         1443                Slow                       Normal   
         1444                Slow                       Little   
         1445            Balanced                       Little   
         1446            Balanced                       Little   
         1447            Balanced                       Little   
         1448            Balanced                       Normal   
         1449            Balanced                       Normal   
         1450            Balanced                       Normal   
         1451            Balanced                       Normal   
         1452            Balanced                       Little   
         1453            Balanced                       Little   
         1454            Balanced                       Little   
         1455            Balanced                       Little   
         1456            Balanced                       Normal   
         1457            Balanced                       Normal   
         
              buildup\_play\_passing\_class buildup\_play\_positioning\_class  \textbackslash{}
         0                         Mixed                      Organised   
         1                         Mixed                      Organised   
         2                         Mixed                      Organised   
         3                          Long                      Organised   
         4                         Mixed                      Organised   
         5                         Mixed                      Organised   
         6                         Mixed                      Organised   
         7                         Mixed                      Organised   
         8                         Mixed                      Organised   
         9                         Mixed                      Organised   
         10                        Mixed                      Organised   
         11                        Mixed                      Organised   
         12                        Mixed                      Organised   
         13                        Mixed                      Organised   
         14                        Mixed                      Organised   
         15                        Short                      Free Form   
         16                        Mixed                      Organised   
         17                        Mixed                      Organised   
         18                        Mixed                      Organised   
         19                        Mixed                      Organised   
         20                        Mixed                      Organised   
         21                        Short                      Organised   
         22                        Mixed                      Organised   
         23                        Mixed                      Organised   
         24                        Mixed                      Organised   
         25                        Mixed                      Organised   
         26                        Mixed                      Organised   
         27                        Mixed                      Organised   
         28                        Mixed                      Organised   
         29                        Mixed                      Organised   
         {\ldots}                         {\ldots}                            {\ldots}   
         1428                      Mixed                      Organised   
         1429                      Short                      Organised   
         1430                      Mixed                      Organised   
         1431                      Mixed                      Organised   
         1432                      Mixed                      Organised   
         1433                      Mixed                      Organised   
         1434                      Mixed                      Organised   
         1435                       Long                      Organised   
         1436                       Long                      Organised   
         1437                      Mixed                      Organised   
         1438                      Mixed                      Organised   
         1439                      Mixed                      Organised   
         1440                      Mixed                      Organised   
         1441                      Mixed                      Organised   
         1442                      Mixed                      Organised   
         1443                      Mixed                      Organised   
         1444                      Short                      Free Form   
         1445                      Mixed                      Organised   
         1446                      Short                      Organised   
         1447                      Short                      Organised   
         1448                      Mixed                      Organised   
         1449                      Mixed                      Organised   
         1450                      Mixed                      Organised   
         1451                      Mixed                      Organised   
         1452                      Mixed                      Organised   
         1453                      Mixed                      Organised   
         1454                      Mixed                      Organised   
         1455                      Mixed                      Organised   
         1456                      Mixed                      Organised   
         1457                      Mixed                      Organised   
         
              chance\_creation\_passing\_class chance\_creation\_crossing\_class  \textbackslash{}
         0                           Normal                         Normal   
         1                           Normal                         Normal   
         2                           Normal                         Normal   
         3                            Risky                           Lots   
         4                           Normal                         Normal   
         5                           Normal                           Lots   
         6                           Normal                         Normal   
         7                           Normal                           Lots   
         8                           Normal                           Lots   
         9                           Normal                         Normal   
         10                          Normal                         Normal   
         11                          Normal                         Normal   
         12                          Normal                         Normal   
         13                          Normal                         Normal   
         14                          Normal                         Normal   
         15                          Normal                         Normal   
         16                          Normal                         Normal   
         17                          Normal                         Little   
         18                          Normal                         Normal   
         19                          Normal                         Normal   
         20                          Normal                         Normal   
         21                          Normal                         Normal   
         22                          Normal                         Normal   
         23                          Normal                         Normal   
         24                          Normal                         Normal   
         25                          Normal                         Normal   
         26                          Normal                         Normal   
         27                            Safe                         Normal   
         28                          Normal                           Lots   
         29                          Normal                         Normal   
         {\ldots}                            {\ldots}                            {\ldots}   
         1428                        Normal                         Normal   
         1429                        Normal                         Normal   
         1430                        Normal                         Normal   
         1431                        Normal                         Normal   
         1432                        Normal                         Normal   
         1433                        Normal                           Lots   
         1434                        Normal                           Lots   
         1435                        Normal                           Lots   
         1436                        Normal                           Lots   
         1437                        Normal                         Normal   
         1438                        Normal                         Normal   
         1439                          Safe                         Normal   
         1440                        Normal                         Normal   
         1441                         Risky                         Normal   
         1442                         Risky                         Normal   
         1443                        Normal                         Normal   
         1444                        Normal                         Normal   
         1445                        Normal                         Normal   
         1446                        Normal                         Normal   
         1447                        Normal                         Normal   
         1448                        Normal                         Normal   
         1449                        Normal                         Normal   
         1450                         Risky                         Normal   
         1451                        Normal                         Normal   
         1452                        Normal                         Normal   
         1453                        Normal                         Normal   
         1454                        Normal                         Normal   
         1455                        Normal                         Normal   
         1456                        Normal                         Normal   
         1457                        Normal                         Normal   
         
              chance\_creation\_shooting\_class chance\_creation\_positioning\_class  \textbackslash{}
         0                            Normal                         Organised   
         1                            Normal                         Organised   
         2                            Normal                         Organised   
         3                              Lots                         Organised   
         4                            Normal                         Organised   
         5                            Normal                         Organised   
         6                            Normal                         Organised   
         7                            Normal                         Organised   
         8                            Normal                         Free Form   
         9                            Normal                         Organised   
         10                           Normal                         Organised   
         11                           Normal                         Organised   
         12                           Normal                         Organised   
         13                           Normal                         Organised   
         14                           Normal                         Organised   
         15                             Lots                         Free Form   
         16                           Normal                         Free Form   
         17                           Normal                         Free Form   
         18                           Normal                         Free Form   
         19                             Lots                         Organised   
         20                             Lots                         Organised   
         21                           Normal                         Organised   
         22                           Normal                         Organised   
         23                           Normal                         Organised   
         24                           Normal                         Organised   
         25                           Normal                         Organised   
         26                           Normal                         Organised   
         27                           Normal                         Organised   
         28                           Normal                         Organised   
         29                           Normal                         Organised   
         {\ldots}                             {\ldots}                               {\ldots}   
         1428                         Normal                         Organised   
         1429                           Lots                         Organised   
         1430                         Normal                         Organised   
         1431                         Normal                         Organised   
         1432                         Normal                         Organised   
         1433                         Normal                         Organised   
         1434                           Lots                         Organised   
         1435                         Normal                         Organised   
         1436                         Normal                         Organised   
         1437                         Normal                         Organised   
         1438                         Normal                         Organised   
         1439                           Lots                         Organised   
         1440                         Normal                         Organised   
         1441                           Lots                         Organised   
         1442                         Normal                         Organised   
         1443                         Normal                         Organised   
         1444                           Lots                         Organised   
         1445                         Normal                         Organised   
         1446                         Normal                         Organised   
         1447                         Normal                         Organised   
         1448                         Normal                         Organised   
         1449                         Normal                         Organised   
         1450                         Normal                         Organised   
         1451                         Normal                         Organised   
         1452                         Normal                         Organised   
         1453                         Normal                         Organised   
         1454                         Normal                         Organised   
         1455                         Little                         Organised   
         1456                         Little                         Organised   
         1457                         Little                         Organised   
         
              defence\_pressure\_class defence\_aggresion\_class defence\_width\_class  \textbackslash{}
         0                    Medium                   Press              Normal   
         1                    Medium                   Press              Normal   
         2                    Medium                   Press              Normal   
         3                    Medium                  Double                Wide   
         4                    Medium                   Press              Normal   
         5                    Medium                   Press              Normal   
         6                    Medium                   Press              Normal   
         7                    Medium                   Press              Normal   
         8                    Medium                   Press              Normal   
         9                      Deep                  Double              Narrow   
         10                   Medium                   Press              Normal   
         11                   Medium                   Press              Normal   
         12                   Medium                   Press              Normal   
         13                   Medium                   Press              Normal   
         14                   Medium                   Press              Normal   
         15                     Deep                   Press              Normal   
         16                   Medium                   Press              Normal   
         17                   Medium                   Press              Normal   
         18                   Medium                   Press              Normal   
         19                   Medium                   Press              Normal   
         20                   Medium                   Press              Normal   
         21                     Deep                 Contain              Narrow   
         22                     Deep                   Press              Normal   
         23                   Medium                   Press              Normal   
         24                   Medium                   Press              Normal   
         25                   Medium                   Press              Normal   
         26                   Medium                   Press              Normal   
         27                     Deep                 Contain              Narrow   
         28                   Medium                   Press              Normal   
         29                   Medium                   Press              Normal   
         {\ldots}                     {\ldots}                     {\ldots}                 {\ldots}   
         1428                 Medium                 Contain              Normal   
         1429                 Medium                   Press              Normal   
         1430                 Medium                   Press                Wide   
         1431                 Medium                   Press              Normal   
         1432                 Medium                   Press              Normal   
         1433                 Medium                   Press              Normal   
         1434                 Medium                   Press              Normal   
         1435                 Medium                   Press              Normal   
         1436                 Medium                   Press              Normal   
         1437                 Medium                   Press              Normal   
         1438                 Medium                   Press              Normal   
         1439                   High                  Double                Wide   
         1440                 Medium                   Press              Normal   
         1441                 Medium                   Press              Normal   
         1442                 Medium                   Press              Normal   
         1443                 Medium                   Press              Normal   
         1444                 Medium                 Contain              Normal   
         1445                 Medium                   Press              Normal   
         1446                 Medium                   Press              Normal   
         1447                 Medium                   Press              Normal   
         1448                 Medium                   Press              Normal   
         1449                 Medium                   Press              Normal   
         1450                 Medium                   Press              Normal   
         1451                 Medium                   Press              Normal   
         1452                   High                   Press                Wide   
         1453                 Medium                   Press              Normal   
         1454                 Medium                   Press              Normal   
         1455                 Medium                   Press              Normal   
         1456                 Medium                   Press              Normal   
         1457                 Medium                   Press              Normal   
         
              defence\_defender\_line\_class  
         0                          Cover  
         1                          Cover  
         2                          Cover  
         3                          Cover  
         4                          Cover  
         5                          Cover  
         6                          Cover  
         7                          Cover  
         8                          Cover  
         9                   Offside Trap  
         10                         Cover  
         11                         Cover  
         12                         Cover  
         13                         Cover  
         14                         Cover  
         15                  Offside Trap  
         16                  Offside Trap  
         17                         Cover  
         18                         Cover  
         19                         Cover  
         20                         Cover  
         21                  Offside Trap  
         22                         Cover  
         23                         Cover  
         24                         Cover  
         25                         Cover  
         26                         Cover  
         27                         Cover  
         28                         Cover  
         29                         Cover  
         {\ldots}                          {\ldots}  
         1428                       Cover  
         1429                       Cover  
         1430                       Cover  
         1431                       Cover  
         1432                       Cover  
         1433                Offside Trap  
         1434                       Cover  
         1435                       Cover  
         1436                       Cover  
         1437                       Cover  
         1438                       Cover  
         1439                       Cover  
         1440                       Cover  
         1441                       Cover  
         1442                       Cover  
         1443                       Cover  
         1444                Offside Trap  
         1445                       Cover  
         1446                       Cover  
         1447                       Cover  
         1448                       Cover  
         1449                       Cover  
         1450                       Cover  
         1451                       Cover  
         1452                       Cover  
         1453                       Cover  
         1454                       Cover  
         1455                       Cover  
         1456                       Cover  
         1457                       Cover  
         
         [1458 rows x 16 columns]
\end{Verbatim}
            
    Now, lets remove the duplicates and null data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}39}]:} 1
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{df\PYZus{}team}\PY{p}{[}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}40}]:}      team\_api\_id        team\_long\_name team\_short\_name rating\_date  \textbackslash{}
         860         9996  Royal Excel Mouscron             MOU  2015-09-10   
         
             buildup\_speed\_class buildup\_play\_dribbling\_class  \textbackslash{}
         860            Balanced                       Normal   
         
             buildup\_play\_passing\_class buildup\_play\_positioning\_class  \textbackslash{}
         860                      Mixed                      Organised   
         
             chance\_creation\_passing\_class chance\_creation\_crossing\_class  \textbackslash{}
         860                        Normal                         Normal   
         
             chance\_creation\_shooting\_class chance\_creation\_positioning\_class  \textbackslash{}
         860                         Normal                         Organised   
         
             defence\_pressure\_class defence\_aggresion\_class defence\_width\_class  \textbackslash{}
         860                 Medium                   Press              Normal   
         
             defence\_defender\_line\_class  
         860                       Cover  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} 0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 1457 entries, 0 to 1457
Data columns (total 16 columns):
team\_api\_id                          1457 non-null int64
team\_long\_name                       1457 non-null object
team\_short\_name                      1457 non-null object
rating\_date                          1457 non-null datetime64[ns]
buildup\_speed\_class                  1457 non-null object
buildup\_play\_dribbling\_class         1457 non-null object
buildup\_play\_passing\_class           1457 non-null object
buildup\_play\_positioning\_class       1457 non-null object
chance\_creation\_passing\_class        1457 non-null object
chance\_creation\_crossing\_class       1457 non-null object
chance\_creation\_shooting\_class       1457 non-null object
chance\_creation\_positioning\_class    1457 non-null object
defence\_pressure\_class               1457 non-null object
defence\_aggresion\_class              1457 non-null object
defence\_width\_class                  1457 non-null object
defence\_defender\_line\_class          1457 non-null object
dtypes: datetime64[ns](1), int64(1), object(14)
memory usage: 193.5+ KB

    \end{Verbatim}

     \#\# Exploratory Data Analysis

    \hypertarget{question-1---which-team-have-improved-over-a-period-of-time}{%
\subsubsection{Question 1 - Which team have improved over a period of
time?}\label{question-1---which-team-have-improved-over-a-period-of-time}}

This is a broad question, as team's improvement could be measured by
matches won, goals scored, foul commits and cards issued.

    For now, Let's look at from matches won. For that, the dataset we have
is: `goals scored by each team (i.e.~home\_team\_goals,
away\_team\_goals)'. So, we need to identify the winning team.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Let\PYZsq{}s filter the data frame to include only necessary columns \PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{n}{win\PYZus{}match\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}end}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}long\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PYZbs{}
                          \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}long\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{win\PYZus{}match\PYZus{}cols}\PY{p}{]}
         \PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:}    match\_id  league\_id             league\_name     season  season\_start  \textbackslash{}
         0    492473          1  Belgium Jupiler League  2008/2009          2008   
         1    492474          1  Belgium Jupiler League  2008/2009          2008   
         2    492475          1  Belgium Jupiler League  2008/2009          2008   
         3    492476          1  Belgium Jupiler League  2008/2009          2008   
         4    492477          1  Belgium Jupiler League  2008/2009          2008   
         
            season\_end  home\_team\_api\_id home\_team\_short\_name home\_team\_long\_name  \textbackslash{}
         0        2009              9987                  GEN            KRC Genk   
         1        2009             10000                  ZUL    SV Zulte-Waregem   
         2        2009              9984                  CEB   KSV Cercle Brugge   
         3        2009              9991                  GEN            KAA Gent   
         4        2009              7947                  DEN       FCV Dender EH   
         
            away\_team\_api\_id away\_team\_short\_name away\_team\_long\_name  home\_team\_goals  \textbackslash{}
         0              9993                  BAC        Beerschot AC                1   
         1              9994                  LOK    Sporting Lokeren                0   
         2              8635                  AND      RSC Anderlecht                0   
         3              9998                  MON           RAEC Mons                5   
         4              9985                  STL   Standard de Lige                1   
         
            away\_team\_goals  
         0                1  
         1                0  
         2                3  
         3                0  
         4                3  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} determine the winning team by comparing the goals \PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{k}{def} \PY{n+nf}{get\PYZus{}winning\PYZus{}team}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{:}
                 \PY{k}{return} \PY{n+nb}{str}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{elif} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                 \PY{k}{return} \PY{n+nb}{str}\PY{p}{(} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No result}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{get\PYZus{}winning\PYZus{}team}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:}    match\_id  league\_id             league\_name     season  season\_start  \textbackslash{}
         0    492473          1  Belgium Jupiler League  2008/2009          2008   
         1    492474          1  Belgium Jupiler League  2008/2009          2008   
         2    492475          1  Belgium Jupiler League  2008/2009          2008   
         3    492476          1  Belgium Jupiler League  2008/2009          2008   
         4    492477          1  Belgium Jupiler League  2008/2009          2008   
         
            season\_end  home\_team\_api\_id home\_team\_short\_name home\_team\_long\_name  \textbackslash{}
         0        2009              9987                  GEN            KRC Genk   
         1        2009             10000                  ZUL    SV Zulte-Waregem   
         2        2009              9984                  CEB   KSV Cercle Brugge   
         3        2009              9991                  GEN            KAA Gent   
         4        2009              7947                  DEN       FCV Dender EH   
         
            away\_team\_api\_id away\_team\_short\_name away\_team\_long\_name  home\_team\_goals  \textbackslash{}
         0              9993                  BAC        Beerschot AC                1   
         1              9994                  LOK    Sporting Lokeren                0   
         2              8635                  AND      RSC Anderlecht                0   
         3              9998                  MON           RAEC Mons                5   
         4              9985                  STL   Standard de Lige                1   
         
            away\_team\_goals winning\_team  
         0                1    No result  
         1                0    No result  
         2                3         8635  
         3                0         9991  
         4                3         9985  
\end{Verbatim}
            
    Now we have determined the winning team, lets find total matches played
the team every season, and total matches won the team every season

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} determine the matches played all the teams \PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}each\PYZus{}team}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{season\PYZus{}start}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
             
             \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame}
             
             \PY{k}{if} \PY{n}{league\PYZus{}id} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{league\PYZus{}id == @league\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                 
             \PY{k}{if} \PY{n}{season\PYZus{}start} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{season\PYZus{}start == @season\PYZus{}start}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}home matches played by the team}
             \PY{n}{home\PYZus{}games\PYZus{}played\PYZus{}team} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
             \PY{n}{home\PYZus{}games\PYZus{}played\PYZus{}team}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{match\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{home\PYZus{}match\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}away matches played by the team}
             \PY{n}{away\PYZus{}games\PYZus{}played\PYZus{}team} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
             \PY{n}{away\PYZus{}games\PYZus{}played\PYZus{}team}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{match\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{away\PYZus{}match\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{home\PYZus{}games\PYZus{}played\PYZus{}team}\PY{p}{,} \PY{n}{away\PYZus{}games\PYZus{}played\PYZus{}team}\PY{p}{,}  \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                                                 \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PYZbs{}
                                                             \PY{o}{+} \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{k}{return} \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}team}
         
         \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Testing the function with a sample league id\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{n}{total\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}each\PYZus{}team}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{total\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}    season\_start  team\_api\_id  home\_match\_count  away\_match\_count  \textbackslash{}
         0          2008         4049                17                17   
         1          2008         7947                17                17   
         2          2008         8203                17                17   
         3          2008         8342                17                17   
         4          2008         8571                17                17   
         
            total\_match\_count  
         0                 34  
         1                 34  
         2                 34  
         3                 34  
         4                 34  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{total\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}each\PYZus{}team}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}\PY{n}{season\PYZus{}start}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
         \PY{n}{total\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:}    season\_start  team\_api\_id  home\_match\_count  away\_match\_count  \textbackslash{}
         0          2015         1773                15                15   
         1          2015         8203                15                15   
         2          2015         8342                15                15   
         3          2015         8475                15                15   
         4          2015         8571                15                15   
         
            total\_match\_count  
         0                 30  
         1                 30  
         2                 30  
         3                 30  
         4                 30  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} determine matches won by each team \PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}matches\PYZus{}won\PYZus{}by\PYZus{}teams}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{season\PYZus{}start} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
             \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame}
             
             \PY{k}{if} \PY{n}{league\PYZus{}id} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{league\PYZus{}id == @league\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                 
             \PY{k}{if} \PY{n}{season\PYZus{}start} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{season\PYZus{}start == @season\PYZus{}start}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                 
             \PY{c+c1}{\PYZsh{}Remove the drawn matches}
             \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{winning\PYZus{}team != }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{No result}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             
             \PY{n}{winning\PYZus{}matches} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
             \PY{n}{winning\PYZus{}matches}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{winning\PYZus{}matches}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
             \PY{n}{winning\PYZus{}matches}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{winning\PYZus{}matches}
         
         \PY{n}{total\PYZus{}won\PYZus{}matches\PYZus{}by\PYZus{}teams} \PY{o}{=}  \PY{n}{get\PYZus{}matches\PYZus{}won\PYZus{}by\PYZus{}teams}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{total\PYZus{}won\PYZus{}matches\PYZus{}by\PYZus{}teams}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:}    season\_start  winning\_team  win\_match\_count
         0          2008         10000               16
         1          2008         10001               15
         2          2008          4049                7
         3          2008          7947                9
         4          2008          8203               12
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{total\PYZus{}won\PYZus{}matches\PYZus{}by\PYZus{}teams} \PY{o}{=}  \PY{n}{get\PYZus{}matches\PYZus{}won\PYZus{}by\PYZus{}teams}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{season\PYZus{}start}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
         \PY{n}{total\PYZus{}won\PYZus{}matches\PYZus{}by\PYZus{}teams}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:}    season\_start  winning\_team  win\_match\_count
         0          2015         10000               12
         1          2015         10001                7
         2          2015          1773                7
         3          2015        274581                7
         4          2015          8203               10
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} This function computes the team who have improved by winnning most matches \PYZdq{}\PYZdq{}\PYZdq{}}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}team\PYZus{}improved\PYZus{}over\PYZus{}the\PYZus{}period}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,}  \PY{n}{league\PYZus{}id} \PY{o}{=} \PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
             
             \PY{n}{all\PYZus{}matches} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}each\PYZus{}team}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{p}{,} \PY{n}{league\PYZus{}id}\PY{o}{=} \PY{n}{league\PYZus{}id}\PY{p}{)}
             \PY{n}{won\PYZus{}matches} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}won\PYZus{}by\PYZus{}teams}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{data\PYZus{}frame}\PY{p}{,} \PY{n}{league\PYZus{}id}\PY{o}{=}\PY{n}{league\PYZus{}id}\PY{p}{)}
             
             \PY{n}{all\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{all\PYZus{}matches}\PY{p}{,} \PY{n}{won\PYZus{}matches}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{all\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{all\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}percentage}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]} \PY{o}{=}  \PY{n}{all\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{all\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             
             \PY{n}{pivoted\PYZus{}data} \PY{o}{=} \PY{n}{all\PYZus{}data}\PY{o}{.}\PY{n}{pivot}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{values}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}    
             \PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}pivoted\PYZus{}data.columns = pivoted\PYZus{}data.columns.str.strip().str.lower().str.replace(\PYZsq{}/\PYZsq{}, \PYZsq{}\PYZus{}\PYZsq{})}
             \PY{n}{last\PYZus{}col\PYZus{}name} \PY{o}{=} \PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{first\PYZus{}col\PYZus{}name} \PY{o}{=} \PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}    
             \PY{n}{pivoted\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}win\PYZus{}percentage\PYZus{}change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pivoted\PYZus{}data}\PY{p}{[}\PY{n}{last\PYZus{}col\PYZus{}name}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{pivoted\PYZus{}data}\PY{p}{[}\PY{n}{first\PYZus{}col\PYZus{}name}\PY{p}{]}
             \PY{k}{return} \PY{n}{pivoted\PYZus{}data}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}win\PYZus{}percentage\PYZus{}change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{get\PYZus{}team\PYZus{}improved\PYZus{}over\PYZus{}the\PYZus{}period}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{l+m+mi}{17642}\PY{p}{)}
         \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}54}]:} season\_start  team\_api\_id      2008  2009      2010  2011  2012      2013  \textbackslash{}
         0                    9772  0.566667   0.8  0.666667   0.7   0.8  0.766667   
         
         season\_start      2014      2015  overall\_win\_percentage\_change  
         0             0.794118  0.852941                       0.286275  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}teams\PYZus{}improved\PYZus{}by\PYZus{}league}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
             \PY{n}{leagues} \PY{o}{=} \PY{n}{data\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
             \PY{n}{teams\PYZus{}improved\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{league} \PY{o+ow}{in} \PY{n}{leagues}\PY{p}{:}
                 \PY{n}{team\PYZus{}improvement} \PY{o}{=} \PY{n}{get\PYZus{}team\PYZus{}improved\PYZus{}over\PYZus{}the\PYZus{}period}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{p}{,} \PY{n}{league}\PY{p}{)}        
                 \PY{n}{teams\PYZus{}improved\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{team\PYZus{}improvement}\PY{p}{)}
             \PY{n}{all\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{teams\PYZus{}improved\PYZus{}list}\PY{p}{,} \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{all\PYZus{}data}
         
         \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league} \PY{o}{=} \PY{n}{get\PYZus{}teams\PYZus{}improved\PYZus{}by\PYZus{}league}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{)}
         \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} season\_start  team\_api\_id      2008      2009      2010      2011      2012  \textbackslash{}
         0                    9991  0.500000  0.500000  0.566667  0.566667  0.266667   
         1                    8586  0.368421  0.552632  0.421053  0.526316  0.552632   
         2                    9847  0.500000  0.315789  0.394737  0.605263  0.657895   
         3                    9789  0.441176  0.470588  0.676471  0.735294  0.558824   
         4                    9875  0.315789  0.394737  0.552632  0.444444  0.605263   
         5                    9791  0.205882  0.500000  0.411765  0.323529  0.264706   
         6                    1601  0.300000  0.533333  0.333333  0.533333  0.266667   
         7                    9772  0.566667  0.800000  0.666667  0.700000  0.800000   
         8                    8485  0.368421  0.263158  0.289474  0.236842  0.289474   
         9                    9906  0.526316  0.342105  0.447368  0.394737  0.605263   
         10                  10199  0.250000  0.472222  0.361111  0.411765  0.277778   
         
         season\_start      2013      2014      2015  overall\_win\_percentage\_change  
         0             0.500000  0.533333  0.566667                       0.066667  
         1             0.552632  0.500000  0.500000                       0.131579  
         2             0.710526  0.631579  0.789474                       0.289474  
         3             0.647059  0.382353  0.705882                       0.264706  
         4             0.605263  0.486486  0.657895                       0.342105  
         5             0.294118  0.323529  0.411765                       0.205882  
         6             0.466667  0.266667  0.366667                       0.066667  
         7             0.766667  0.794118  0.852941                       0.286275  
         8             0.526316  0.605263  0.578947                       0.210526  
         9             0.736842  0.605263  0.736842                       0.210526  
         10            0.416667  0.333333  0.416667                       0.166667  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Lets find the team\PYZsq{}s name and league\PYZsq{}s name \PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{k}{def} \PY{n+nf}{get\PYZus{}all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{(}\PY{n}{dataframe}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
         
             \PY{n}{home\PYZus{}team\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{away\PYZus{}team\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
             \PY{n}{df\PYZus{}home\PYZus{}team\PYZus{}info} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{home\PYZus{}team\PYZus{}cols}\PY{p}{]}
             \PY{n}{df\PYZus{}home\PYZus{}team\PYZus{}info}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{home\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{team\PYZus{}short\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{df\PYZus{}away\PYZus{}team\PYZus{}info} \PY{o}{=} \PY{n}{dataframe}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{away\PYZus{}team\PYZus{}cols}\PY{p}{]}
             \PY{n}{df\PYZus{}away\PYZus{}team\PYZus{}info}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{team\PYZus{}api\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{away\PYZus{}team\PYZus{}short\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{team\PYZus{}short\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
             \PY{n}{combined\PYZus{}team\PYZus{}league\PYZus{}info} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{df\PYZus{}home\PYZus{}team\PYZus{}info}\PY{p}{,} \PY{n}{df\PYZus{}away\PYZus{}team\PYZus{}info}\PY{p}{]}\PY{p}{,} \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{combined\PYZus{}team\PYZus{}league\PYZus{}info}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{combined\PYZus{}team\PYZus{}league\PYZus{}info}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{combined\PYZus{}team\PYZus{}league\PYZus{}info}
         
         \PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info} \PY{o}{=} \PY{n}{get\PYZus{}all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{)}
         \PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{(}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} 
         \PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:}                     league\_name  team\_api\_id team\_short\_name  \textbackslash{}
         0        Belgium Jupiler League         9987             GEN   
         1        Belgium Jupiler League        10000             ZUL   
         2        Belgium Jupiler League         9984             CEB   
         3        Belgium Jupiler League         9991             GEN   
         4        Belgium Jupiler League         7947             DEN   
         5        Belgium Jupiler League         8203             MEC   
         6        Belgium Jupiler League         9999             ROS   
         7        Belgium Jupiler League         4049             TUB   
         8        Belgium Jupiler League        10001             WES   
         9        Belgium Jupiler League         8342             CLB   
         10       Belgium Jupiler League         9985             STL   
         12       Belgium Jupiler League         9994             LOK   
         15       Belgium Jupiler League         9996             MOU   
         17       Belgium Jupiler League         9993             BAC   
         18       Belgium Jupiler League         8635             AND   
         19       Belgium Jupiler League         9998             MON   
         20       Belgium Jupiler League         9986             CHA   
         24       Belgium Jupiler League         8571             KOR   
         315      Belgium Jupiler League         9997             STT   
         531      Belgium Jupiler League         9989             LIE   
         537      Belgium Jupiler League         6351             EUP   
         756      Belgium Jupiler League         1773             O-H   
         1011     Belgium Jupiler League         8475             WAA   
         1239     Belgium Jupiler League         8573             OOS   
         1259     Belgium Jupiler League       274581             MOP   
         1728     England Premier League        10260             MUN   
         1729     England Premier League         9825             ARS   
         1730     England Premier League         8472             SUN   
         1731     England Premier League         8654             WHU   
         1732     England Premier League        10252             AVL   
         {\ldots}                         {\ldots}          {\ldots}             {\ldots}   
         21544           Spain LIGA BBVA        10281             VAL   
         21546           Spain LIGA BBVA         8479             HUE   
         21901           Spain LIGA BBVA         8394             ZAR   
         21907           Spain LIGA BBVA         9867             TEN   
         21919           Spain LIGA BBVA         9868             XER   
         22278           Spain LIGA BBVA        10278             HER   
         22282           Spain LIGA BBVA         8581             LEV   
         22284           Spain LIGA BBVA         8560             SOC   
         22666           Spain LIGA BBVA         8370             RAY   
         22676           Spain LIGA BBVA         7878             GRA   
         23043           Spain LIGA BBVA         9910             CEL   
         23429           Spain LIGA BBVA        10268             ELC   
         23802           Spain LIGA BBVA         8372             EIB   
         23818           Spain LIGA BBVA         7869             COR   
         24200           Spain LIGA BBVA         8306             LAS   
         24557  Switzerland Super League         9956             GRA   
         24558  Switzerland Super League        10192              YB   
         24559  Switzerland Super League         9930             AAR   
         24560  Switzerland Super League        10199             LUZ   
         24561  Switzerland Super League         7955             XAM   
         24562  Switzerland Super League         6493             BEL   
         24563  Switzerland Super League         9931             BAS   
         24564  Switzerland Super League        10179             SIO   
         24565  Switzerland Super League         9824             VAD   
         24566  Switzerland Super League        10243             ZUR   
         24739  Switzerland Super League        10190             GAL   
         24918  Switzerland Super League        10191             THU   
         25100  Switzerland Super League         9777             SER   
         25105  Switzerland Super League         7730             LAU   
         25815  Switzerland Super League         7896             LUG   
         
                             team\_league\_name  
         0        Belgium Jupiler League(GEN)  
         1        Belgium Jupiler League(ZUL)  
         2        Belgium Jupiler League(CEB)  
         3        Belgium Jupiler League(GEN)  
         4        Belgium Jupiler League(DEN)  
         5        Belgium Jupiler League(MEC)  
         6        Belgium Jupiler League(ROS)  
         7        Belgium Jupiler League(TUB)  
         8        Belgium Jupiler League(WES)  
         9        Belgium Jupiler League(CLB)  
         10       Belgium Jupiler League(STL)  
         12       Belgium Jupiler League(LOK)  
         15       Belgium Jupiler League(MOU)  
         17       Belgium Jupiler League(BAC)  
         18       Belgium Jupiler League(AND)  
         19       Belgium Jupiler League(MON)  
         20       Belgium Jupiler League(CHA)  
         24       Belgium Jupiler League(KOR)  
         315      Belgium Jupiler League(STT)  
         531      Belgium Jupiler League(LIE)  
         537      Belgium Jupiler League(EUP)  
         756      Belgium Jupiler League(O-H)  
         1011     Belgium Jupiler League(WAA)  
         1239     Belgium Jupiler League(OOS)  
         1259     Belgium Jupiler League(MOP)  
         1728     England Premier League(MUN)  
         1729     England Premier League(ARS)  
         1730     England Premier League(SUN)  
         1731     England Premier League(WHU)  
         1732     England Premier League(AVL)  
         {\ldots}                              {\ldots}  
         21544           Spain LIGA BBVA(VAL)  
         21546           Spain LIGA BBVA(HUE)  
         21901           Spain LIGA BBVA(ZAR)  
         21907           Spain LIGA BBVA(TEN)  
         21919           Spain LIGA BBVA(XER)  
         22278           Spain LIGA BBVA(HER)  
         22282           Spain LIGA BBVA(LEV)  
         22284           Spain LIGA BBVA(SOC)  
         22666           Spain LIGA BBVA(RAY)  
         22676           Spain LIGA BBVA(GRA)  
         23043           Spain LIGA BBVA(CEL)  
         23429           Spain LIGA BBVA(ELC)  
         23802           Spain LIGA BBVA(EIB)  
         23818           Spain LIGA BBVA(COR)  
         24200           Spain LIGA BBVA(LAS)  
         24557  Switzerland Super League(GRA)  
         24558   Switzerland Super League(YB)  
         24559  Switzerland Super League(AAR)  
         24560  Switzerland Super League(LUZ)  
         24561  Switzerland Super League(XAM)  
         24562  Switzerland Super League(BEL)  
         24563  Switzerland Super League(BAS)  
         24564  Switzerland Super League(SIO)  
         24565  Switzerland Super League(VAD)  
         24566  Switzerland Super League(ZUR)  
         24739  Switzerland Super League(GAL)  
         24918  Switzerland Super League(THU)  
         25100  Switzerland Super League(SER)  
         25105  Switzerland Super League(LAU)  
         25815  Switzerland Super League(LUG)  
         
         [299 rows x 4 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league} \PY{o}{=} \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{all\PYZus{}team\PYZus{}league\PYZus{}info}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:}     team\_api\_id      2008      2009      2010      2011      2012      2013  \textbackslash{}
         0          9991  0.500000  0.500000  0.566667  0.566667  0.266667  0.500000   
         1          8586  0.368421  0.552632  0.421053  0.526316  0.552632  0.552632   
         2          9847  0.500000  0.315789  0.394737  0.605263  0.657895  0.710526   
         3          9789  0.441176  0.470588  0.676471  0.735294  0.558824  0.647059   
         4          9875  0.315789  0.394737  0.552632  0.444444  0.605263  0.605263   
         5          9791  0.205882  0.500000  0.411765  0.323529  0.264706  0.294118   
         6          1601  0.300000  0.533333  0.333333  0.533333  0.266667  0.466667   
         7          9772  0.566667  0.800000  0.666667  0.700000  0.800000  0.766667   
         8          8485  0.368421  0.263158  0.289474  0.236842  0.289474  0.526316   
         9          9906  0.526316  0.342105  0.447368  0.394737  0.605263  0.736842   
         10        10199  0.250000  0.472222  0.361111  0.411765  0.277778  0.416667   
         
                 2014      2015  overall\_win\_percentage\_change  \textbackslash{}
         0   0.533333  0.566667                       0.066667   
         1   0.500000  0.500000                       0.131579   
         2   0.631579  0.789474                       0.289474   
         3   0.382353  0.705882                       0.264706   
         4   0.486486  0.657895                       0.342105   
         5   0.323529  0.411765                       0.205882   
         6   0.266667  0.366667                       0.066667   
         7   0.794118  0.852941                       0.286275   
         8   0.605263  0.578947                       0.210526   
         9   0.605263  0.736842                       0.210526   
         10  0.333333  0.416667                       0.166667   
         
                          league\_name team\_short\_name               team\_league\_name  
         0     Belgium Jupiler League             GEN    Belgium Jupiler League(GEN)  
         1     England Premier League             TOT    England Premier League(TOT)  
         2             France Ligue 1             PSG            France Ligue 1(PSG)  
         3      Germany 1. Bundesliga             DOR     Germany 1. Bundesliga(DOR)  
         4              Italy Serie A             NAP             Italy Serie A(NAP)  
         5     Netherlands Eredivisie             HER    Netherlands Eredivisie(HER)  
         6         Poland Ekstraklasa             CHO        Poland Ekstraklasa(CHO)  
         7   Portugal Liga ZON Sagres             BEN  Portugal Liga ZON Sagres(BEN)  
         8    Scotland Premier League             ABE   Scotland Premier League(ABE)  
         9            Spain LIGA BBVA             AMA           Spain LIGA BBVA(AMA)  
         10  Switzerland Super League             LUZ  Switzerland Super League(LUZ)  
\end{Verbatim}
            
    Season Column has both start and end year. To plot the trend graph, only
one year is needed. Let's pick season start year

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{season\PYZus{}cols} \PY{o}{=} \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{unwanted\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}win\PYZus{}percentage\PYZus{}change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}short\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league\PYZus{}filtered} \PY{o}{=}  \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{unwanted\PYZus{}cols}\PY{p}{,} \PY{n}{axis} \PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league\PYZus{}filtered} 
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}59}]:}         2008      2009      2010      2011      2012      2013      2014  \textbackslash{}
         0   0.500000  0.500000  0.566667  0.566667  0.266667  0.500000  0.533333   
         1   0.368421  0.552632  0.421053  0.526316  0.552632  0.552632  0.500000   
         2   0.500000  0.315789  0.394737  0.605263  0.657895  0.710526  0.631579   
         3   0.441176  0.470588  0.676471  0.735294  0.558824  0.647059  0.382353   
         4   0.315789  0.394737  0.552632  0.444444  0.605263  0.605263  0.486486   
         5   0.205882  0.500000  0.411765  0.323529  0.264706  0.294118  0.323529   
         6   0.300000  0.533333  0.333333  0.533333  0.266667  0.466667  0.266667   
         7   0.566667  0.800000  0.666667  0.700000  0.800000  0.766667  0.794118   
         8   0.368421  0.263158  0.289474  0.236842  0.289474  0.526316  0.605263   
         9   0.526316  0.342105  0.447368  0.394737  0.605263  0.736842  0.605263   
         10  0.250000  0.472222  0.361111  0.411765  0.277778  0.416667  0.333333   
         
                 2015               team\_league\_name  
         0   0.566667    Belgium Jupiler League(GEN)  
         1   0.500000    England Premier League(TOT)  
         2   0.789474            France Ligue 1(PSG)  
         3   0.705882     Germany 1. Bundesliga(DOR)  
         4   0.657895             Italy Serie A(NAP)  
         5   0.411765    Netherlands Eredivisie(HER)  
         6   0.366667        Poland Ekstraklasa(CHO)  
         7   0.852941  Portugal Liga ZON Sagres(BEN)  
         8   0.578947   Scotland Premier League(ABE)  
         9   0.736842           Spain LIGA BBVA(AMA)  
         10  0.416667  Switzerland Super League(LUZ)  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{transposed\PYZus{}data} \PY{o}{=}  \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league\PYZus{}filtered}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{]}
         \PY{n}{transposed\PYZus{}data} \PY{o}{=} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{transposed\PYZus{}data}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} 8  year Belgium Jupiler League(GEN) England Premier League(TOT)  \textbackslash{}
         0  2008                         0.5                    0.368421   
         1  2009                         0.5                    0.552632   
         2  2010                    0.566667                    0.421053   
         3  2011                    0.566667                    0.526316   
         4  2012                    0.266667                    0.552632   
         5  2013                         0.5                    0.552632   
         6  2014                    0.533333                         0.5   
         7  2015                    0.566667                         0.5   
         
         8 France Ligue 1(PSG) Germany 1. Bundesliga(DOR) Italy Serie A(NAP)  \textbackslash{}
         0                 0.5                   0.441176           0.315789   
         1            0.315789                   0.470588           0.394737   
         2            0.394737                   0.676471           0.552632   
         3            0.605263                   0.735294           0.444444   
         4            0.657895                   0.558824           0.605263   
         5            0.710526                   0.647059           0.605263   
         6            0.631579                   0.382353           0.486486   
         7            0.789474                   0.705882           0.657895   
         
         8 Netherlands Eredivisie(HER) Poland Ekstraklasa(CHO)  \textbackslash{}
         0                    0.205882                     0.3   
         1                         0.5                0.533333   
         2                    0.411765                0.333333   
         3                    0.323529                0.533333   
         4                    0.264706                0.266667   
         5                    0.294118                0.466667   
         6                    0.323529                0.266667   
         7                    0.411765                0.366667   
         
         8 Portugal Liga ZON Sagres(BEN) Scotland Premier League(ABE)  \textbackslash{}
         0                      0.566667                     0.368421   
         1                           0.8                     0.263158   
         2                      0.666667                     0.289474   
         3                           0.7                     0.236842   
         4                           0.8                     0.289474   
         5                      0.766667                     0.526316   
         6                      0.794118                     0.605263   
         7                      0.852941                     0.578947   
         
         8 Spain LIGA BBVA(AMA) Switzerland Super League(LUZ)  
         0             0.526316                          0.25  
         1             0.342105                      0.472222  
         2             0.447368                      0.361111  
         3             0.394737                      0.411765  
         4             0.605263                      0.277778  
         5             0.736842                      0.416667  
         6             0.605263                      0.333333  
         7             0.736842                      0.416667  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{}transposed\PYZus{}data.plot(figsize=(15,15), x=\PYZsq{}year\PYZsq{})}
         \PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} 
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{transposed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{n}{transposed\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{question-2---which-team-have-improved-over-a-period-of-time}{%
\subsubsection{Question 2 - Which team have improved over a period of
time?}\label{question-2---which-team-have-improved-over-a-period-of-time}}

To answer the above, we can use the `penalties' rating for all the
players

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 180354 entries, 0 to 183977
Data columns (total 30 columns):
player\_api\_id          180354 non-null int64
player\_name            180354 non-null object
rating\_date            180354 non-null datetime64[ns]
penalties              180354 non-null float64
overall\_rating         180354 non-null float64
attacking\_work\_rate    180354 non-null object
potential              180354 non-null float64
finishing              180354 non-null float64
heading\_accuracy       180354 non-null float64
short\_passing          180354 non-null float64
volleys                180354 non-null float64
dribbling              180354 non-null float64
curve                  180354 non-null float64
free\_kick\_accuracy     180354 non-null float64
long\_passing           180354 non-null float64
ball\_control           180354 non-null float64
acceleration           180354 non-null float64
sprint\_speed           180354 non-null float64
agility                180354 non-null float64
reactions              180354 non-null float64
balance                180354 non-null float64
shot\_power             180354 non-null float64
jumping                180354 non-null float64
stamina                180354 non-null float64
strength               180354 non-null float64
long\_shots             180354 non-null float64
aggression             180354 non-null float64
positioning            180354 non-null float64
vision                 180354 non-null float64
marking                180354 non-null float64
dtypes: datetime64[ns](1), float64(26), int64(1), object(2)
memory usage: 42.7+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{df\PYZus{}player\PYZus{}interesting\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating} \PY{o}{=} \PY{n}{df\PYZus{}player}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{df\PYZus{}player\PYZus{}interesting\PYZus{}cols}\PY{p}{]}
         \PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:}    player\_api\_id         player\_name rating\_date  penalties
         0         505942  Aaron Appindangoye  2016-02-18       48.0
         1         505942  Aaron Appindangoye  2015-11-19       48.0
         2         505942  Aaron Appindangoye  2015-09-21       48.0
         3         505942  Aaron Appindangoye  2015-03-20       47.0
         4         505942  Aaron Appindangoye  2007-02-22       47.0
\end{Verbatim}
            
    Looking at the above data, the player has been rated multiple times in
the same year, in the above table, you can see `Aaron' was rated
2015-09-21 and 2015-03-20.

Let's calculate mean average rating per player every year.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{year}
         \PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:}    player\_api\_id         player\_name rating\_date  penalties  rating\_year
         0         505942  Aaron Appindangoye  2016-02-18       48.0         2016
         1         505942  Aaron Appindangoye  2015-11-19       48.0         2015
         2         505942  Aaron Appindangoye  2015-09-21       48.0         2015
         3         505942  Aaron Appindangoye  2015-03-20       47.0         2015
         4         505942  Aaron Appindangoye  2007-02-22       47.0         2007
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year} \PY{o}{=} \PY{n}{df\PYZus{}player\PYZus{}penalty\PYZus{}rating}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}66}]:}        player\_api\_id             player\_name  rating\_year  penalties
         0               2625       Patryk Rachwal,18         2007  46.000000
         1               2625       Patryk Rachwal,18         2008  46.000000
         2               2625       Patryk Rachwal,18         2010  69.000000
         3               2625       Patryk Rachwal,18         2011  66.000000
         4               2625       Patryk Rachwal,18         2012  66.000000
         5               2625       Patryk Rachwal,18         2013  66.000000
         6               2625       Patryk Rachwal,18         2014  66.000000
         7               2625       Patryk Rachwal,18         2015  66.000000
         8               2752             Diego Mainz         2007  35.000000
         9               2752             Diego Mainz         2008  35.000000
         10              2752             Diego Mainz         2010  35.000000
         11              2752             Diego Mainz         2011  35.000000
         12              2752             Diego Mainz         2012  35.000000
         13              2752             Diego Mainz         2013  35.000000
         14              2752             Diego Mainz         2014  35.500000
         15              2752             Diego Mainz         2015  37.000000
         16              2768             Jose Dorado         2007  63.000000
         17              2768             Jose Dorado         2008  63.000000
         18              2768             Jose Dorado         2009  63.000000
         19              2768             Jose Dorado         2010  38.000000
         20              2768             Jose Dorado         2011  13.000000
         21              2768             Jose Dorado         2012  13.000000
         22              2768             Jose Dorado         2013  37.000000
         23              2768             Jose Dorado         2014  25.000000
         24              2768             Jose Dorado         2015  16.000000
         25              2768             Jose Dorado         2016  16.000000
         26              2770        Ignacio Gonzalez         2007  45.000000
         27              2770        Ignacio Gonzalez         2008  45.000000
         28              2770        Ignacio Gonzalez         2009  64.000000
         29              2770        Ignacio Gonzalez         2010  68.000000
         {\ldots}              {\ldots}                     {\ldots}          {\ldots}        {\ldots}
         70911         725718  Dennis van der Heijden         2007  55.000000
         70912         725718  Dennis van der Heijden         2016  55.000000
         70913         726956            Cedric Itten         2007  64.000000
         70914         726956            Cedric Itten         2016  64.000000
         70915         728125  Christopher McLaughlin         2007  38.000000
         70916         728125  Christopher McLaughlin         2016  38.000000
         70917         728414           Justin Hoogma         2007  35.000000
         70918         728414           Justin Hoogma         2016  35.000000
         70919         728478           Kamil Jozwiak         2007  52.000000
         70920         728478           Kamil Jozwiak         2016  52.000000
         70921         730065            Jorge Intima         2007  59.000000
         70922         730065            Jorge Intima         2016  59.000000
         70923         733787            Linus Obexer         2007  40.000000
         70924         733787            Linus Obexer         2016  40.000000
         70925         742405              Tom Davies         2007  42.000000
         70926         742405              Tom Davies         2016  42.000000
         70927         743720          Charles Pickel         2007  40.000000
         70928         743720          Charles Pickel         2016  40.000000
         70929         744907             Greg Taylor         2007  52.000000
         70930         744907             Greg Taylor         2015  52.285714
         70931         744907             Greg Taylor         2016  53.000000
         70932         746419        Francisco Afonso         2007  43.000000
         70933         746419        Francisco Afonso         2016  43.000000
         70934         748432          Fynn Arkenberg         2007  45.000000
         70935         748432          Fynn Arkenberg         2016  45.000000
         70936         750435          Rees Greenwood         2007  61.000000
         70937         750435          Rees Greenwood         2015  61.000000
         70938         750435          Rees Greenwood         2016  61.000000
         70939         750584       Alexandre Azevedo         2007  52.000000
         70940         750584       Alexandre Azevedo         2016  52.000000
         
         [70941 rows x 4 columns]
\end{Verbatim}
            
    Lets find out for how many years for data we have players

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2007
2016
             player\_api\_id  player\_name  penalties
rating\_year                                       
2007                 10410        10410      10410
2008                  4905         4905       4905
2009                  5663         5663       5663
2010                  6571         6571       6571
2011                  7153         7153       7153
2012                  7459         7459       7459
2013                  7896         7896       7896
2014                  7796         7796       7796
2015                  7502         7502       7502
2016                  5586         5586       5586

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{max\PYZus{}year} \PY{o}{=}  \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} 
         \PY{n}{start\PYZus{}year} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)} 
\end{Verbatim}


    Let's make sure, we include only the players have rating from 2007 to
2016. So that, we dont include players played recently and include them
for calculation (as it might skue the result)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{values}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                                           \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                                                                           \PY{n}{columns}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
         \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}69}]:} Index(['player\_api\_id', 'player\_name', '2007', '2008', '2009', '2010', '2011',
                '2012', '2013', '2014', '2015', '2016'],
               dtype='object', name='rating\_year')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} rating\_year  player\_api\_id       player\_name  2007  2008  2009  2010  2011  \textbackslash{}
         1675                 30714   Francesco Totti  81.0  89.0  89.5  91.0  92.0   
         1776                 30909       David Villa  74.0  79.0  86.0  89.0  92.0   
         1629                 30631     Frank Lampard  87.0  88.0  88.0  88.5  90.0   
         1174                 26440      Timmy Simons  84.5  89.0  89.0  85.0  85.0   
         1734                 30843  Robin van Persie  80.5  86.0  86.0  88.0  91.0   
         
         rating\_year  2012       2013       2014       2015       2016  overall\_avg  
         1675         91.0  90.000000  89.818182  90.000000  88.666667    89.198485  
         1776         92.0  91.666667  92.000000  92.000000  92.000000    87.966667  
         1629         91.0  90.333333  86.000000  84.600000  84.000000    87.743333  
         1174         88.0  87.400000  87.400000  89.500000  90.000000    87.480000  
         1734         92.0  89.000000  86.272727  84.666667  84.000000    86.743939  
\end{Verbatim}
            
    Now let's find the top players with highest avg.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n}{top\PYZus{}10\PYZus{}players\PYZus{}with\PYZus{}penalty\PYZus{}rating} \PY{o}{=} \PY{n}{df\PYZus{}avg\PYZus{}penalties\PYZus{}per\PYZus{}player\PYZus{}per\PYZus{}year\PYZus{}pvt\PYZus{}table}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)} \PYZbs{}
                                                 \PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{top\PYZus{}10\PYZus{}players\PYZus{}with\PYZus{}penalty\PYZus{}rating}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}73}]:} rating\_year       player\_name  overall\_avg
         1675          Francesco Totti    89.198485
         1776              David Villa    87.966667
         1629            Frank Lampard    87.743333
         1174             Timmy Simons    87.480000
         1734         Robin van Persie    86.743939
         1688             Andrea Pirlo    86.703333
         1616            Cesc Fabregas    86.700000
         3575                     Kaka    86.550000
         1619           Steven Gerrard    86.488889
         2175             Samuel Eto'o    86.230000
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{top\PYZus{}10\PYZus{}players\PYZus{}with\PYZus{}penalty\PYZus{}rating}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{barh}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}76}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x2866506f630>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{question-3-which-team-attributes-lead-to-most-victories}{%
\subsubsection{Question 3: Which team attributes lead to most
victories?}\label{question-3-which-team-attributes-lead-to-most-victories}}

    First lets look at the team attributes and their distributions. Lets
consider year `2015' for this analysis.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}232}]:} \PY{n}{df\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{year}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}236}]:} \PY{n}{team\PYZus{}attributes\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}class}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{x} \PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}246}]:} \PY{k}{def} \PY{n+nf}{show\PYZus{}popular\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
              
              \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame}
              \PY{n}{empty\PYZus{}data} \PY{o}{=}  \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{object}\PY{p}{)}
              \PY{n}{top\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{empty\PYZus{}data}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{)}
              
              \PY{k}{if} \PY{n}{rating\PYZus{}year} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                  \PY{n}{data\PYZus{}frame\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rating\PYZus{}year == @rating\PYZus{}year}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              
              \PY{n}{nrows} \PY{o}{=} \PY{l+m+mi}{3}
              \PY{n}{ncols} \PY{o}{=} \PY{l+m+mi}{4}
              \PY{n}{plot\PYZus{}index} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
          
              \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{:}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{nrows}\PY{p}{,} \PY{n}{ncols}\PY{p}{,} \PY{n}{plot\PYZus{}index}\PY{p}{)}        
                  \PY{n}{data\PYZus{}frame\PYZus{}filtered}\PY{p}{[}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{[}\PY{n}{plot\PYZus{}index} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{top\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class}\PY{p}{[}\PY{n}{c}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}team}\PY{p}{[}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{[}\PY{n}{plot\PYZus{}index} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{[}\PY{n}{plot\PYZus{}index} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{plot\PYZus{}index} \PY{o}{=} \PY{n}{plot\PYZus{}index} \PY{o}{+} \PY{l+m+mi}{1}
          
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
              \PY{k}{return} \PY{n}{top\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class}
          
          \PY{n}{popular\PYZus{}team\PYZus{}attr\PYZus{}2015} \PY{o}{=} \PY{n}{show\PYZus{}popular\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
          \PY{n}{popular\PYZus{}team\PYZus{}attr\PYZus{}2015}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}246}]:} buildup\_speed\_class                   Balanced
          buildup\_play\_dribbling\_class            Little
          buildup\_play\_passing\_class               Mixed
          buildup\_play\_positioning\_class       Organised
          chance\_creation\_passing\_class           Normal
          chance\_creation\_crossing\_class          Normal
          chance\_creation\_shooting\_class          Normal
          chance\_creation\_positioning\_class    Organised
          defence\_pressure\_class                  Medium
          defence\_aggresion\_class                  Press
          defence\_width\_class                     Normal
          defence\_defender\_line\_class              Cover
          dtype: object
\end{Verbatim}
            
    Let's find out how often the team being rated.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{df\PYZus{}team\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buildup\PYZus{}speed\PYZus{}class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         \PY{n}{df\PYZus{}team\PYZus{}grouped\PYZus{}data} \PY{o}{=} \PY{n}{df\PYZus{}team\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ \PYZhy{} No. of teams rated more than twice in a year }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}team\PYZus{}grouped\PYZus{}data}\PY{o}{.}\PY{n}{buildup\PYZus{}speed\PYZus{}class} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ \PYZhy{} Team rating start year}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{rating\PYZus{}year}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{ \PYZhy{} Team rating end year}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{rating\PYZus{}year}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0 - No. of teams rated more than twice in a year 
2010 - Team rating start year
2015 - Team rating end year

    \end{Verbatim}

    It seems every team is rated once in a year. So, We can assume the team
attributes are rated once the season starts. Now, We can check which
team attribute contributes team win or not.

    Now lets find out the team matches played and win for every year
(season)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}247}]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{team\PYZus{}attr\PYZus{}name}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
              \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} First We need to figure out the teams following different classes of attributes \PYZsq{}\PYZsq{}\PYZsq{}}
              \PY{n}{df\PYZus{}team\PYZus{}filtered} \PY{o}{=} \PY{n}{data\PYZus{}frame}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rating\PYZus{}year == @rating\PYZus{}year}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n}{df\PYZus{}team\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}team\PYZus{}filtered}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{team\PYZus{}attr\PYZus{}name}\PY{p}{]}\PY{p}{]}
              \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}year} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}each\PYZus{}team}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PYZbs{}
                                                                                   \PY{n}{season\PYZus{}start}\PY{o}{=}\PY{n}{rating\PYZus{}year}\PY{p}{)}
              \PY{n}{won\PYZus{}matches\PYZus{}by\PYZus{}team\PYZus{}year} \PY{o}{=} \PY{n}{get\PYZus{}matches\PYZus{}won\PYZus{}by\PYZus{}teams}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{df\PYZus{}match\PYZus{}win\PYZus{}matches\PYZus{}filtered}\PY{p}{,} \PY{n}{season\PYZus{}start}\PY{o}{=}\PY{n}{rating\PYZus{}year}\PY{p}{)}
              
              \PY{n}{merged\PYZus{}df\PYZus{}matches} \PY{o}{=} \PY{n}{all\PYZus{}matches\PYZus{}played\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}year}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{won\PYZus{}matches\PYZus{}by\PYZus{}team\PYZus{}year}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}} \PYZbs{}
                                                                                            \PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PYZbs{}
                                                                                            \PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{winning\PYZus{}team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              
              \PY{n}{merged\PYZus{}df} \PY{o}{=} \PY{n}{df\PYZus{}team\PYZus{}filtered}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{merged\PYZus{}df\PYZus{}matches}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PYZbs{}
                                                                   \PY{p}{,}\PY{n}{right\PYZus{}on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{season\PYZus{}start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}    \PY{p}{)}
              \PY{n}{merged\PYZus{}df} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{team\PYZus{}attr\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
              \PY{n}{team\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{team\PYZus{}attr\PYZus{}name}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
              \PY{n}{match\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{team\PYZus{}attr\PYZus{}name}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
              \PY{n}{win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{team\PYZus{}attr\PYZus{}name}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
              
              \PY{n}{merge\PYZus{}team\PYZus{}attr\PYZus{}with\PYZus{}match\PYZus{}data\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{team\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{p}{,} \PY{n}{match\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{p}{,} \PYZbs{}
                                                                  \PY{n}{win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{merge\PYZus{}team\PYZus{}attr\PYZus{}with\PYZus{}match\PYZus{}data\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merge\PYZus{}team\PYZus{}attr\PYZus{}with\PYZus{}match\PYZus{}data\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{merge\PYZus{}team\PYZus{}attr\PYZus{}with\PYZus{}match\PYZus{}data\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}match\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
              \PY{k}{return} \PY{n}{merge\PYZus{}team\PYZus{}attr\PYZus{}with\PYZus{}match\PYZus{}data\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}249}]:} \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{get\PYZus{}team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{df\PYZus{}team}\PY{p}{,}\PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{,}\PY{n}{team\PYZus{}attr\PYZus{}name}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buildup\PYZus{}speed\PYZus{}class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}249}]:}                      team\_api\_id  total\_match\_count  win\_match\_count  \textbackslash{}
          buildup\_speed\_class                                                    
          Balanced                     158               5622             2083   
          Fast                          15                534              247   
          Slow                           3                102               34   
          
                               win\_percentage  
          buildup\_speed\_class                  
          Balanced                   0.370509  
          Fast                       0.462547  
          Slow                       0.333333  
\end{Verbatim}
            
    From the above data, popular team attribute, may not always win the
matches. For instance, `Balanced' approach is followed by multiple teams
for `Build Up Speed', but `Free' approach win more matches (by looking
at the win percentage).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}250}]:} \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{get\PYZus{}team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=} \PY{l+m+mi}{2015}\PY{p}{,} \PY{n}{team\PYZus{}attr\PYZus{}name}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buildup\PYZus{}play\PYZus{}positioning\PYZus{}class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}250}]:}                                 team\_api\_id  total\_match\_count  \textbackslash{}
          buildup\_play\_positioning\_class                                   
          Free Form                                10                348   
          Organised                               166               5910   
          
                                          win\_match\_count  win\_percentage  
          buildup\_play\_positioning\_class                                   
          Free Form                                   176        0.505747  
          Organised                                  2188        0.370220  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}256}]:} \PY{k}{def} \PY{n+nf}{show\PYZus{}win\PYZus{}percentage\PYZus{}for\PYZus{}all\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{team\PYZus{}attributes\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{df\PYZus{}team}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}class}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{x} \PY{p}{]}
              
              \PY{n}{nrows} \PY{o}{=} \PY{l+m+mi}{3}
              \PY{n}{ncols} \PY{o}{=} \PY{l+m+mi}{4}
              \PY{n}{plot\PYZus{}index} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
              \PY{n}{empty\PYZus{}data} \PY{o}{=}  \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{object}\PY{p}{)}
              \PY{n}{high\PYZus{}win\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{empty\PYZus{}data}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{)}
             
              \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{:}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{nrows}\PY{p}{,} \PY{n}{ncols}\PY{p}{,} \PY{n}{plot\PYZus{}index}\PY{p}{)}        
                  \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr} \PY{o}{=} \PY{n}{get\PYZus{}team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}by\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{data\PYZus{}frame}\PY{p}{,} \PYZbs{}
                                                                                               \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{n}{rating\PYZus{}year}\PY{p}{,} \PYZbs{}
                                                                                               \PY{n}{team\PYZus{}attr\PYZus{}name}\PY{o}{=} \PY{n}{c}\PY{p}{)}
                  \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{high\PYZus{}win\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class}\PY{p}{[}\PY{n}{c}\PY{p}{]} \PY{o}{=} \PY{n}{team\PYZus{}match\PYZus{}win\PYZus{}count\PYZus{}by\PYZus{}team\PYZus{}attr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win\PYZus{}percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{team\PYZus{}attributes\PYZus{}cols}\PY{p}{[}\PY{n}{plot\PYZus{}index} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{win percentage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{plot\PYZus{}index} \PY{o}{=} \PY{n}{plot\PYZus{}index} \PY{o}{+} \PY{l+m+mi}{1}
          
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}    
              \PY{k}{return} \PY{n}{high\PYZus{}win\PYZus{}team\PYZus{}attr\PYZus{}in\PYZus{}every\PYZus{}class}
          \PY{n}{team\PYZus{}attr\PYZus{}with\PYZus{}high\PYZus{}win\PYZus{}percentage\PYZus{}2015} \PY{o}{=} \PY{n}{show\PYZus{}win\PYZus{}percentage\PYZus{}for\PYZus{}all\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_120_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The below function could be generate mark down table. It may be used for
later, if needed

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}245}]:} \PY{c+c1}{\PYZsh{}| This | is   |}
          \PY{c+c1}{\PYZsh{}|\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}|\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}|}
          \PY{c+c1}{\PYZsh{}|   a  | table|}
          
          \PY{k}{class} \PY{n+nc}{DictToTableConvertor}\PY{p}{(}\PY{n+nb}{dict}\PY{p}{)}\PY{p}{:}   
              \PY{k}{def} \PY{n+nf}{convert\PYZus{}to\PYZus{}table\PYZus{}markdown}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                  \PY{n}{line}    \PY{o}{=}       \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{| Team Attribute Class | Attribute Class Type With Highest Win }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{|}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}        
                  \PY{n}{line}\PY{o}{.}\PY{n}{append}    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{|\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}|\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}|}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                  \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                      \PY{n}{line}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{|      }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{     |     }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{            |}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{key}\PY{p}{,} \PY{n}{value}\PY{p}{)}\PY{p}{)}
                  \PY{k}{return} \PY{n}{line}
          \PY{n}{dict\PYZus{}table} \PY{o}{=} \PY{n}{DictToTableConvertor}\PY{p}{(}\PY{n}{team\PYZus{}attr\PYZus{}with\PYZus{}high\PYZus{}win\PYZus{}percentage\PYZus{}2015}\PY{p}{)}
          \PY{n}{lines} \PY{o}{=}  \PY{n}{dict\PYZus{}table}\PY{o}{.}\PY{n}{convert\PYZus{}to\PYZus{}table\PYZus{}markdown}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{lines}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
| Team Attribute Class | Attribute Class Type With Highest Win \%|
|----------------------|-----------------------------------------|
|      buildup\_speed\_class     |     Fast            |
|      buildup\_play\_dribbling\_class     |     Little            |
|      buildup\_play\_passing\_class     |     Short            |
|      buildup\_play\_positioning\_class     |     Free Form            |
|      chance\_creation\_passing\_class     |     Risky            |
|      chance\_creation\_crossing\_class     |     Little            |
|      chance\_creation\_shooting\_class     |     Lots            |
|      chance\_creation\_positioning\_class     |     Free Form            |
|      defence\_pressure\_class     |     High            |
|      defence\_aggresion\_class     |     Double            |
|      defence\_width\_class     |     Normal            |
|      defence\_defender\_line\_class     |     Offside Trap            |

    \end{Verbatim}

    \hypertarget{question-4-is-refree-partial-towards-home-team-during-a-match}{%
\subsubsection{Question 4: Is refree partial towards home team during a
match?}\label{question-4-is-refree-partial-towards-home-team-during-a-match}}

    To answer the above question, lets find out number of cards issued
against the home team vs away team.

To get this data, we need to drop the null values in match dataframe

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{n}{match\PYZus{}card\PYZus{}interesting\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}
          
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{match\PYZus{}card\PYZus{}interesting\PYZus{}cols}\PY{p}{]}
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PYZbs{}
                                                              \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}ycard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PYZbs{}
                                                              \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}rcard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{o}{+} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}118}]:}       home\_team\_api\_id  home\_team\_ycard  home\_team\_rcard  \textbackslash{}
          1728             10260              3.0              0.0   
          1730              8472              0.0              0.0   
          1731              8654              2.0              0.0   
          1732             10252              0.0              0.0   
          1733              8668              2.0              0.0   
          
                home\_team\_foulcommit  away\_team\_api\_id  away\_team\_ycard  \textbackslash{}
          1728                  16.0             10261              0.0   
          1730                  13.0              8650              2.0   
          1731                  14.0              8528              1.0   
          1732                  11.0              8456              1.0   
          1733                  11.0              8655              2.0   
          
                away\_team\_rcard  away\_team\_foulcommit  home\_team\_total\_cards  \textbackslash{}
          1728              0.0                  11.0                    3.0   
          1730              0.0                  12.0                    0.0   
          1731              0.0                  13.0                    2.0   
          1732              0.0                  13.0                    0.0   
          1733              0.0                  11.0                    2.0   
          
                away\_team\_total\_cards  total\_cards  
          1728                    0.0          3.0  
          1730                    2.0          2.0  
          1731                    1.0          3.0  
          1732                    1.0          1.0  
          1733                    2.0          4.0  
\end{Verbatim}
            
    Let's find out the total cards in all the matches

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}all\PYZus{}matches} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
          \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}all\PYZus{}matches}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}125}]:} 35930.0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}away\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
          \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}away\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}126}]:} 19582.0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}home\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
          \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}home\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}127}]:} 16348.0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{n}{away\PYZus{}team\PYZus{}card\PYZus{}percentage} \PY{o}{=} \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}away\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches} \PY{o}{/}\PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}all\PYZus{}matches}
          \PY{n}{home\PYZus{}team\PYZus{}card\PYZus{}percentage} \PY{o}{=} \PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}home\PYZus{}team\PYZus{}for\PYZus{}all\PYZus{}matches} \PY{o}{/}\PY{n}{total\PYZus{}cards\PYZus{}for\PYZus{}all\PYZus{}matches}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}135}]:} \PY{n}{barlist} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Away Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,}\PY{p}{[}\PY{n}{away\PYZus{}team\PYZus{}card\PYZus{}percentage}\PY{p}{,}\PY{n}{home\PYZus{}team\PYZus{}card\PYZus{}percentage} \PY{p}{]}\PY{p}{)}
          \PY{n}{barlist}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Card Issue }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Card Issuing }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ (Home Vs Away)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_131_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    It seems Away team is getting more cards than Home Team. Let's see who
commits more fouls and check its related.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{match\PYZus{}card\PYZus{}and\PYZus{}foul\PYZus{}interesting\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}and\PYZus{}foul} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}filtered}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{match\PYZus{}card\PYZus{}and\PYZus{}foul\PYZus{}interesting\PYZus{}cols}\PY{p}{]}
          \PY{n}{pd}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{scatter\PYZus{}matrix}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}and\PYZus{}foul}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}141}]:} array([[<matplotlib.axes.\_subplots.AxesSubplot object at 0x000002865F88C5F8>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x00000286637DD0B8>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x00000286625A9E80>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028664375668>],
                 [<matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028663F99A58>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028663F99DA0>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028661AF9208>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028661393438>],
                 [<matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028666A019E8>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x00000286667829B0>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x000002866353EEF0>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028665573080>],
                 [<matplotlib.axes.\_subplots.AxesSubplot object at 0x000002866564D630>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x00000286656CD0B8>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028661F306A0>,
                  <matplotlib.axes.\_subplots.AxesSubplot object at 0x0000028662BA50B8>]],
                dtype=object)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}265}]:} \PY{k}{def} \PY{n+nf}{show\PYZus{}correlation\PYZus{}between\PYZus{}home\PYZus{}and\PYZus{}away\PYZus{}teams\PYZus{}cards}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
              
              \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{data\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{data\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Home Team Foul Vs Total Cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foul commit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{data\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{n}{data\PYZus{}frame}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}total\PYZus{}cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Away Team Foul Vs Total Cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{foul commit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total cards}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              \PY{k}{return} \PY{k+kc}{None}
          
          \PY{n}{show\PYZus{}correlation\PYZus{}between\PYZus{}home\PYZus{}and\PYZus{}away\PYZus{}teams\PYZus{}cards}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}and\PYZus{}foul}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_134_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    From the above plots, it seems foul commit is strongly related to cards
issued. Though the away teams tends to get more cards than home team, it
seems away team commits more fouls. So the refree is fare.

    \hypertarget{question-5-what-are-the-chances-of-away-team-winning-a-game-even-after-committing-more-fouls-than-home-team}{%
\subsubsection{Question 5: What are the chances of away team winning a
game, even after committing more fouls than home
team?}\label{question-5-what-are-the-chances-of-away-team-winning-a-game-even-after-committing-more-fouls-than-home-team}}

    For this, we need to find two things: 1. Determine whether its home win
or away win 2. Away Win counts, when away team commits more fouls than
home team

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{n}{match\PYZus{}foulcommit\PYZus{}interesting\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                                               \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}
          
          \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Filter the data frame with only interested columns\PYZdq{}\PYZdq{}\PYZdq{}}
          \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{match\PYZus{}foulcommit\PYZus{}interesting\PYZus{}cols}\PY{p}{]}
          
          \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Drop any null values \PYZdq{}\PYZdq{}\PYZdq{}}
          \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
          
          \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Ignore any drawn matches\PYZdq{}\PYZdq{}\PYZdq{}}
          \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{o}{\PYZti{}}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
          \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}159}]:}       home\_team\_api\_id  home\_team\_goals  home\_team\_foulcommit  \textbackslash{}
          1729              9825                1                  11.0   
          1730              8472                0                  13.0   
          1731              8654                2                  14.0   
          1732             10252                4                  11.0   
          1733              8668                2                  11.0   
          
                away\_team\_api\_id  away\_team\_goals  away\_team\_foulcommit  
          1729              8659                0                   9.0  
          1730              8650                1                  12.0  
          1731              8528                1                  13.0  
          1732              8456                2                  13.0  
          1733              8655                3                  11.0  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}163}]:} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}result}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}goals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HomeWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}163}]:}       home\_team\_api\_id  home\_team\_goals  home\_team\_foulcommit  \textbackslash{}
          1729              9825                1                  11.0   
          1730              8472                0                  13.0   
          1731              8654                2                  14.0   
          1732             10252                4                  11.0   
          1733              8668                2                  11.0   
          
                away\_team\_api\_id  away\_team\_goals  away\_team\_foulcommit match\_result  
          1729              8659                0                   9.0      HomeWin  
          1730              8650                1                  12.0      AwayWin  
          1731              8528                1                  13.0      HomeWin  
          1732              8456                2                  13.0      HomeWin  
          1733              8655                3                  11.0      AwayWin  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}179}]:} \PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{team\PYZus{}win\PYZus{}count} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}result}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}api\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Matches with Results: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Match Results (Away Win Vs Home Win)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of AwayWin: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of HomeWin: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HomeWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
          \PY{n}{team\PYZus{}win\PYZus{}count}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Total Matches with Results: 6350

Match Results (Away Win Vs Home Win)
match\_result
AwayWin    2433
HomeWin    3917
Name: home\_team\_api\_id, dtype: int64
Percentage of AwayWin: 0.3831496062992126
Percentage of HomeWin: 0.6168503937007874

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}179}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x28662d40eb8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_140_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    From the above graph, it seems Home Team tends to win more than Away
Team

    Out of 6350 (match with result), away team won only 2433 matches. Chance
of Away Team winning a match is 0.38.

Now, lets particularly look at the Away team win matches and see if away
team's chances of winning a match

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}181}]:} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered\PYZus{}away\PYZus{}win} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}result}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{matches\PYZus{}away\PYZus{}team\PYZus{}committed\PYZus{}more\PYZus{}fouls} \PY{o}{=} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered\PYZus{}away\PYZus{}win}\PY{p}{[}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered\PYZus{}away\PYZus{}win}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{away\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered\PYZus{}away\PYZus{}win}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home\PYZus{}team\PYZus{}foulcommit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{]}
          \PY{n}{away\PYZus{}team\PYZus{}win\PYZus{}count\PYZus{}committing\PYZus{}more\PYZus{}fouls} \PY{o}{=} \PY{n}{matches\PYZus{}away\PYZus{}team\PYZus{}committed\PYZus{}more\PYZus{}fouls}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{match\PYZus{}result}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
          \PY{n}{away\PYZus{}team\PYZus{}win\PYZus{}count\PYZus{}committing\PYZus{}more\PYZus{}fouls}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}181}]:} AwayWin    1103
          Name: match\_result, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}183}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of Away Win even after committing more fouls than home team: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PYZbs{}
                \PY{n}{away\PYZus{}team\PYZus{}win\PYZus{}count\PYZus{}committing\PYZus{}more\PYZus{}fouls}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Percentage of Away Win even after committing more fouls than home team: 0.1737007874015748

    \end{Verbatim}

    Away team chances of winning reduces further from `0.38' to `0.17', when
they commit more fouls.

     \#\# Conclusion

    \hypertarget{question-1-which-soccer-team-have-improved-the-most-over-the-period-of-time}{%
\subsubsection{Question 1 Which Soccer team have improved the most over
the period of
time?}\label{question-1-which-soccer-team-have-improved-the-most-over-the-period-of-time}}

From the year 2008 to 2015, Below is the list of teams from each league
who has improved over the period. Of all the teams, `Napoli (NAP)' win
percentage improved from 31.58\% to 65.79\%.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}188}]:} \PY{n}{team\PYZus{}improved\PYZus{}the\PYZus{}most\PYZus{}from\PYZus{}each\PYZus{}league}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{2008}\PY{p}{,} \PY{l+m+mi}{2015}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{team\PYZus{}league\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}win\PYZus{}percentage\PYZus{}change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{overall\PYZus{}win\PYZus{}percentage\PYZus{}change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}188}]:}         2008      2015               team\_league\_name  \textbackslash{}
          4   0.315789  0.657895             Italy Serie A(NAP)   
          2   0.500000  0.789474            France Ligue 1(PSG)   
          7   0.566667  0.852941  Portugal Liga ZON Sagres(BEN)   
          3   0.441176  0.705882     Germany 1. Bundesliga(DOR)   
          8   0.368421  0.578947   Scotland Premier League(ABE)   
          9   0.526316  0.736842           Spain LIGA BBVA(AMA)   
          5   0.205882  0.411765    Netherlands Eredivisie(HER)   
          10  0.250000  0.416667  Switzerland Super League(LUZ)   
          1   0.368421  0.500000    England Premier League(TOT)   
          0   0.500000  0.566667    Belgium Jupiler League(GEN)   
          6   0.300000  0.366667        Poland Ekstraklasa(CHO)   
          
              overall\_win\_percentage\_change  
          4                        0.342105  
          2                        0.289474  
          7                        0.286275  
          3                        0.264706  
          8                        0.210526  
          9                        0.210526  
          5                        0.205882  
          10                       0.166667  
          1                        0.131579  
          0                        0.066667  
          6                        0.066667  
\end{Verbatim}
            
    \hypertarget{question-2-which-soccer-player-has-the-best-rating-for-penalties}{%
\subsubsection{Question 2: Which Soccer Player has the best rating for
penalties?}\label{question-2-which-soccer-player-has-the-best-rating-for-penalties}}

    Below is the list of players with highest penalty average

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}189}]:} \PY{n}{top\PYZus{}10\PYZus{}players\PYZus{}with\PYZus{}penalty\PYZus{}rating}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}189}]:} rating\_year       player\_name  overall\_avg
          1675          Francesco Totti    89.198485
          1776              David Villa    87.966667
          1629            Frank Lampard    87.743333
          1174             Timmy Simons    87.480000
          1734         Robin van Persie    86.743939
          1688             Andrea Pirlo    86.703333
          1616            Cesc Fabregas    86.700000
          3575                     Kaka    86.550000
          1619           Steven Gerrard    86.488889
          2175             Samuel Eto'o    86.230000
\end{Verbatim}
            
    It seems `Francesco Totti' tops the penalty rating. We can also look at
the penalty rating for him over the years

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}204}]:} \PY{n}{totti\PYZus{}penalty\PYZus{}rating} \PY{o}{=} \PY{n}{df\PYZus{}player}\PY{p}{[}\PY{n}{df\PYZus{}player}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{player\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Francesco Totti}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
          \PY{n}{totti\PYZus{}penalty\PYZus{}rating}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{totti\PYZus{}penalty\PYZus{}rating}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{year}
          \PY{n}{totti\PYZus{}penalty\PYZus{}rating\PYZus{}avg\PYZus{}year} \PY{o}{=} \PY{n}{totti\PYZus{}penalty\PYZus{}rating}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{totti\PYZus{}penalty\PYZus{}rating\PYZus{}avg\PYZus{}year}
          \PY{n}{sns}\PY{o}{.}\PY{n}{pointplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalties}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{totti\PYZus{}penalty\PYZus{}rating\PYZus{}avg\PYZus{}year}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}204}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x286601f3908>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_153_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can conclude has always been rated high throught his careers, except
the dip during his initial career stage

    \hypertarget{question-3-which-team-attributes-lead-to-most-victories}{%
\subsubsection{Question 3: Which team attributes lead to most
victories?}\label{question-3-which-team-attributes-lead-to-most-victories}}

    Here is the list of popular attribute type followed by differnt teams
for the year 2015

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}257}]:} \PY{n}{popular\PYZus{}team\PYZus{}attr\PYZus{}2015} \PY{o}{=} \PY{n}{show\PYZus{}popular\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=} \PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_157_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Here is the list of team attributes which provided maximum victories
(proposition-wise)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}258}]:} \PY{n}{high\PYZus{}win\PYZus{}percentage\PYZus{}team\PYZus{}attr\PYZus{}2015} \PY{o}{=} \PY{n}{show\PYZus{}win\PYZus{}percentage\PYZus{}for\PYZus{}all\PYZus{}team\PYZus{}attr}\PY{p}{(}\PY{n}{data\PYZus{}frame}\PY{o}{=} \PY{n}{df\PYZus{}team}\PY{p}{,} \PY{n}{rating\PYZus{}year}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_159_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}260}]:} \PY{n}{df\PYZus{}team\PYZus{}attr\PYZus{}popular\PYZus{}versus\PYZus{}high\PYZus{}win} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{popular\PYZus{}team\PYZus{}attr\PYZus{}2015}\PY{p}{,} \PY{n}{high\PYZus{}win\PYZus{}percentage\PYZus{}team\PYZus{}attr\PYZus{}2015}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{df\PYZus{}team\PYZus{}attr\PYZus{}popular\PYZus{}versus\PYZus{}high\PYZus{}win}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{popular\PYZus{}attribute\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{high\PYZus{}win\PYZus{}attribute\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df\PYZus{}team\PYZus{}attr\PYZus{}popular\PYZus{}versus\PYZus{}high\PYZus{}win}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}260}]:}                                   popular\_attribute\_type  \textbackslash{}
          buildup\_speed\_class                             Balanced   
          buildup\_play\_dribbling\_class                      Little   
          buildup\_play\_passing\_class                         Mixed   
          buildup\_play\_positioning\_class                 Organised   
          chance\_creation\_passing\_class                     Normal   
          chance\_creation\_crossing\_class                    Normal   
          chance\_creation\_shooting\_class                    Normal   
          chance\_creation\_positioning\_class              Organised   
          defence\_pressure\_class                            Medium   
          defence\_aggresion\_class                            Press   
          defence\_width\_class                               Normal   
          defence\_defender\_line\_class                        Cover   
          
                                            high\_win\_attribute\_type  
          buildup\_speed\_class                                  Fast  
          buildup\_play\_dribbling\_class                       Little  
          buildup\_play\_passing\_class                          Short  
          buildup\_play\_positioning\_class                  Free Form  
          chance\_creation\_passing\_class                       Risky  
          chance\_creation\_crossing\_class                     Little  
          chance\_creation\_shooting\_class                       Lots  
          chance\_creation\_positioning\_class               Free Form  
          defence\_pressure\_class                               High  
          defence\_aggresion\_class                            Double  
          defence\_width\_class                                Normal  
          defence\_defender\_line\_class                  Offside Trap  
\end{Verbatim}
            
    From the above table, We can conclude that popular team attribute may
not always win the matches.

    \hypertarget{question-4-is-refree-partial-towards-home-team-during-a-match}{%
\subsubsection{Question 4 Is refree partial towards home team during a
match?}\label{question-4-is-refree-partial-towards-home-team-during-a-match}}

    Though `Away Team' tends to get more cards than `Home Team' (as
explained in Exploratory Data Analysis Phase). It seems the `Away Team'
commits more foul than `Home Team', as we can see the positive
correlation between cards and foul commits.

So, Refree is fare. Its the away team who tends to commit more fouls
responsible for getting more cards against them.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}266}]:} \PY{n}{how\PYZus{}correlation\PYZus{}between\PYZus{}home\PYZus{}and\PYZus{}away\PYZus{}teams\PYZus{}cards}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}card\PYZus{}and\PYZus{}foul}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_164_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{question-5-what-are-the-chances-of-away-team-winning-a-game-even-after-committing-more-fouls-than-home-team}{%
\subsubsection{Question 5 What are the chances of away team winning a
game, even after committing more fouls than home
team?}\label{question-5-what-are-the-chances-of-away-team-winning-a-game-even-after-committing-more-fouls-than-home-team}}

    It seems `Away Team' tends to win less against Home Team. `Away Team'
have won only 17.4 out of 100 matches, when they have committed more
fouls than `Home Team'.

So, Away team should play more responsible when they travel outside.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}269}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Matches with Results: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df\PYZus{}match\PYZus{}foulcommit\PYZus{}filtered}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Match Results (Away Win Vs Home Win)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of AwayWin: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of HomeWin: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{team\PYZus{}win\PYZus{}count}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HomeWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percentage of Away Win even after committing more fouls than home team: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(} \PYZbs{}
                \PY{n}{away\PYZus{}team\PYZus{}win\PYZus{}count\PYZus{}committing\PYZus{}more\PYZus{}fouls}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AwayWin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{match\PYZus{}count\PYZus{}with\PYZus{}result}\PY{p}{)}\PY{p}{)}
          \PY{n}{team\PYZus{}win\PYZus{}count}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Total Matches with Results: 6350

Match Results (Away Win Vs Home Win)
match\_result
AwayWin    2433
HomeWin    3917
Name: home\_team\_api\_id, dtype: int64
Percentage of AwayWin: 38.31496062992126
Percentage of HomeWin: 61.68503937007874
Percentage of Away Win even after committing more fouls than home team: 17.37007874015748

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}269}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x28672731c50>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_167_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
